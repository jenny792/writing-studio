<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cefund Studio</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg:         #191919;
      --sidebar:    #1e1e1e;
      --surface:    #252525;
      --hover:      #2d2d2d;
      --border:     #2a2a2a;
      --text:       #e3e1dc;
      --muted:      #9a9792;
      --gold:       #c9a96e;
      --linkedin:   #5b8fde;
      --panel:      #1e1e1e;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg);
      color: var(--text);
      height: 100vh;
      overflow: hidden;
      display: flex;
      font-size: 13px;
    }

    /* ─── SIDEBAR ─────────────────────────────────── */
    .sidebar {
      width: 250px;
      min-width: 250px;
      background: var(--sidebar);
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      overflow-y: auto;
      overflow-x: hidden;
    }

    .sidebar-logo {
      padding: 18px 16px 14px;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      gap: 9px;
      font-weight: 600;
      font-size: 14px;
      letter-spacing: -0.2px;
      color: var(--text);
    }

    .sidebar-logo .logo-mark {
      width: 26px;
      height: 26px;
      background: linear-gradient(135deg, var(--gold) 0%, #a07840 100%);
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 700;
      color: #1a1610;
      flex-shrink: 0;
    }

    .sidebar-search {
      margin: 12px 10px 4px;
      position: relative;
    }

    .sidebar-search input {
      width: 100%;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 6px 10px 6px 30px;
      font-family: inherit;
      font-size: 12px;
      color: var(--muted);
      outline: none;
      transition: border-color 0.15s;
    }

    .sidebar-search input:focus {
      border-color: #3a3a3a;
      color: var(--text);
    }

    .sidebar-search .search-icon {
      position: absolute;
      left: 9px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--muted);
      font-size: 11px;
    }

    .sidebar-section {
      padding: 18px 0 6px;
    }

    .sidebar-section-label {
      padding: 0 16px 6px;
      font-size: 10px;
      font-weight: 600;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--muted);
    }

    .sidebar-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 5px 16px;
      cursor: pointer;
      border-radius: 0;
      transition: background 0.1s;
      user-select: none;
      position: relative;
      color: var(--text);
      text-decoration: none;
    }

    .sidebar-item:hover {
      background: var(--hover);
    }

    .sidebar-item.active {
      background: rgba(201, 169, 110, 0.1);
      color: var(--gold);
    }

    .sidebar-item.active::before {
      content: '';
      position: absolute;
      left: 0;
      top: 2px;
      bottom: 2px;
      width: 2px;
      background: var(--gold);
      border-radius: 0 2px 2px 0;
    }

    .sidebar-item .item-icon { font-size: 14px; flex-shrink: 0; }
    .sidebar-item .item-text { flex: 1; font-size: 12.5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .sidebar-item .item-arrow { color: var(--muted); font-size: 10px; transition: transform 0.15s; }
    .sidebar-item.expanded .item-arrow { transform: rotate(90deg); }

    .sidebar-sub {
      overflow: hidden;
      max-height: 0;
      transition: max-height 0.2s ease;
    }

    .sidebar-sub.open { max-height: 300px; }

    .sidebar-sub-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 4px 16px 4px 36px;
      cursor: pointer;
      transition: background 0.1s;
      color: var(--muted);
      font-size: 12px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .sidebar-sub-item:hover { background: var(--hover); color: var(--text); }
    .sidebar-sub-item.active { color: var(--gold); }

    .sidebar-divider {
      height: 1px;
      background: var(--border);
      margin: 8px 0;
    }

    /* ─── MAIN CONTENT ────────────────────────────── */
    .main {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      background: var(--bg);
    }

    .main-topbar {
      padding: 14px 28px;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-shrink: 0;
    }

    .breadcrumb {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      color: var(--muted);
    }

    .breadcrumb .crumb { cursor: pointer; transition: color 0.1s; }
    .breadcrumb .crumb:hover { color: var(--text); }
    .breadcrumb .sep { font-size: 10px; }
    .breadcrumb .crumb.current { color: var(--text); }

    .topbar-actions {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 14px;
      border-radius: 6px;
      font-family: inherit;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      border: none;
      transition: all 0.15s;
    }

    .btn-ghost {
      background: transparent;
      color: var(--muted);
      border: 1px solid var(--border);
    }
    .btn-ghost:hover { background: var(--hover); color: var(--text); border-color: #3a3a3a; }

    .btn-gold {
      background: var(--gold);
      color: #1a1610;
      font-weight: 600;
    }
    .btn-gold:hover { background: #d4b580; }

    .main-content {
      flex: 1;
      overflow-y: auto;
      padding: 40px 60px;
    }

    .main-content.batch-mode {
      padding: 0;
    }

    .doc-icon { font-size: 32px; margin-bottom: 14px; display: block; }

    .doc-title {
      font-size: 26px;
      font-weight: 600;
      letter-spacing: -0.5px;
      color: var(--text);
      margin-bottom: 8px;
      line-height: 1.2;
    }

    .doc-meta {
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 32px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .doc-meta .dot { font-size: 4px; }

    .doc-divider {
      border: none;
      border-top: 1px dashed var(--border);
      margin: 0 0 32px;
    }

    .doc-body {
      max-width: 640px;
      line-height: 1.75;
      font-size: 14px;
      color: #ccc9c4;
    }

    .doc-body p { margin-bottom: 18px; }
    .doc-body h2 { font-size: 17px; font-weight: 600; color: var(--text); margin: 32px 0 12px; }
    .doc-body h3 { font-size: 14px; font-weight: 600; color: var(--text); margin: 24px 0 8px; }

    .doc-body blockquote {
      border-left: 2px solid var(--gold);
      padding-left: 16px;
      color: var(--muted);
      font-style: italic;
      margin: 20px 0;
    }

    .doc-source-btn {
      display: inline-flex;
      align-items: center;
      gap: 7px;
      margin-top: 32px;
      padding: 8px 16px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 7px;
      font-size: 12px;
      font-weight: 500;
      color: var(--muted);
      cursor: pointer;
      transition: all 0.15s;
    }

    .doc-source-btn:hover {
      background: var(--hover);
      color: var(--gold);
      border-color: rgba(201,169,110,0.3);
    }

    /* ─── POST VIEWS ──────────────────────────────── */
    .posts-view, .published-view { display: none; padding: 0; }
    .posts-view.active, .published-view.active { display: block; }

    .post-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 18px 22px;
      margin-bottom: 12px;
      cursor: pointer;
      transition: all 0.15s;
      max-width: 640px;
    }

    .post-card:hover { background: var(--hover); border-color: #363636; }

    .post-card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .post-platform {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      font-size: 11px;
      font-weight: 500;
      padding: 3px 8px;
      border-radius: 4px;
    }

    .post-platform.linkedin { background: rgba(91,143,222,0.15); color: var(--linkedin); }
    .post-platform.instagram {
      background: linear-gradient(135deg, rgba(130,80,200,0.15), rgba(220,70,130,0.15));
      color: #d870a0;
    }

    .post-date { font-size: 11px; color: var(--muted); }

    .post-card-title {
      font-size: 13px;
      font-weight: 500;
      color: var(--text);
      margin-bottom: 6px;
    }

    .post-card-preview {
      font-size: 12px;
      color: var(--muted);
      line-height: 1.6;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
    }

    /* ─── GENERATE PANEL ──────────────────────────── */
    .generate-panel {
      width: 340px;
      min-width: 340px;
      background: var(--panel);
      border-left: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      overflow-y: auto;
      transition: width 0.2s, min-width 0.2s, opacity 0.2s;
    }

    .generate-panel.hidden {
      width: 0;
      min-width: 0;
      overflow: hidden;
      opacity: 0;
    }

    .panel-header {
      padding: 18px 20px 14px;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-shrink: 0;
    }

    .panel-title {
      font-size: 13px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 7px;
      color: var(--text);
    }

    .panel-close {
      width: 22px;
      height: 22px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 4px;
      cursor: pointer;
      color: var(--muted);
      font-size: 14px;
      transition: all 0.1s;
    }

    .panel-close:hover { background: var(--hover); color: var(--text); }

    .panel-body {
      padding: 18px 20px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      flex: 1;
    }

    .panel-section-label {
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: var(--muted);
      margin-bottom: 8px;
    }

    /* Platform tabs */
    .platform-tabs {
      display: flex;
      gap: 6px;
    }

    .platform-tab {
      flex: 1;
      padding: 7px 10px;
      border-radius: 7px;
      border: 1px solid var(--border);
      background: transparent;
      font-family: inherit;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s;
      text-align: center;
      color: var(--muted);
    }

    .platform-tab:hover { background: var(--hover); }

    .platform-tab.active.linkedin {
      background: rgba(91,143,222,0.15);
      color: var(--linkedin);
      border-color: rgba(91,143,222,0.3);
    }

    .platform-tab.active.instagram {
      background: linear-gradient(135deg, rgba(130,80,200,0.15), rgba(220,70,130,0.15));
      color: #d870a0;
      border-color: rgba(200,100,160,0.3);
    }

    /* Source checkboxes */
    .source-list { display: flex; flex-direction: column; gap: 7px; }

    .source-item {
      display: flex;
      align-items: center;
      gap: 9px;
      cursor: pointer;
      padding: 5px 8px;
      border-radius: 6px;
      transition: background 0.1s;
      font-size: 12.5px;
      color: var(--muted);
    }

    .source-item:hover { background: var(--hover); color: var(--text); }
    .source-item.checked { color: var(--text); }

    .source-item input[type="checkbox"] {
      accent-color: var(--gold);
      width: 13px;
      height: 13px;
      cursor: pointer;
      flex-shrink: 0;
    }

    /* Tone select */
    .tone-select {
      width: 100%;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 7px;
      padding: 8px 12px;
      font-family: inherit;
      font-size: 12.5px;
      color: var(--text);
      outline: none;
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'%3E%3Cpath fill='%239a9792' d='M0 0l5 6 5-6z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 10px center;
      padding-right: 28px;
      transition: border-color 0.15s;
    }

    .tone-select:focus { border-color: #3a3a3a; }
    .tone-select option { background: #252525; }

    /* Generate button */
    .generate-btn {
      width: 100%;
      padding: 10px;
      background: var(--gold);
      color: #1a1610;
      border: none;
      border-radius: 8px;
      font-family: inherit;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 7px;
      transition: all 0.15s;
    }

    .generate-btn:hover { background: #d4b580; transform: translateY(-1px); }
    .generate-btn:active { transform: translateY(0); }

    /* Panel divider */
    .panel-divider {
      height: 1px;
      background: var(--border);
      margin: 0 -20px;
    }

    /* Preview */
    .preview-box {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 14px;
      min-height: 140px;
      font-size: 12.5px;
      line-height: 1.65;
      color: var(--muted);
      flex: 1;
    }

    .preview-box.has-content { color: var(--text); }

    .preview-generating {
      display: none;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      color: var(--muted);
      margin-top: 10px;
    }

    .preview-generating.show { display: flex; }

    .spinner {
      width: 14px;
      height: 14px;
      border: 2px solid var(--border);
      border-top-color: var(--gold);
      border-radius: 50%;
      animation: spin 0.7s linear infinite;
    }

    @keyframes spin { to { transform: rotate(360deg); } }

    /* Copy button for preview */
    .preview-actions {
      display: none;
      justify-content: flex-end;
      gap: 6px;
      margin-top: 10px;
    }

    .preview-actions.show { display: flex; }

    .btn-copy {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 5px 12px;
      font-family: inherit;
      font-size: 11px;
      font-weight: 500;
      color: var(--muted);
      cursor: pointer;
      transition: all 0.15s;
    }

    .btn-copy:hover { background: var(--hover); color: var(--text); }

    .btn-copy:disabled {
      opacity: 0.5;
      cursor: default;
    }

    .btn-added {
      color: #6dbf7e !important;
      border-color: rgba(109,191,126,0.3) !important;
    }

    /* CSV footer */
    .csv-footer {
      border-top: 1px solid var(--border);
      padding: 14px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      flex-shrink: 0;
    }

    .csv-queue {
      font-size: 11.5px;
      color: var(--muted);
    }

    .csv-queue strong {
      color: var(--text);
      font-variant-numeric: tabular-nums;
    }

    .csv-download-btn {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 6px 13px;
      background: transparent;
      border: 1px solid var(--border);
      border-radius: 6px;
      font-family: inherit;
      font-size: 11.5px;
      font-weight: 500;
      color: var(--muted);
      cursor: pointer;
      transition: all 0.15s;
      white-space: nowrap;
    }

    .csv-download-btn:hover:not(:disabled) {
      background: var(--hover);
      color: var(--text);
      border-color: #3a3a3a;
    }

    .csv-download-btn:disabled { opacity: 0.35; cursor: default; }

    .csv-download-btn.ready {
      border-color: rgba(201,169,110,0.4);
      color: var(--gold);
    }

    .csv-download-btn.ready:hover {
      background: rgba(201,169,110,0.08);
      border-color: rgba(201,169,110,0.6);
    }

    /* ─── MODAL ───────────────────────────────────── */
    .modal-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      z-index: 200;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(3px);
    }

    .modal-overlay.open { display: flex; }

    .modal {
      background: #242424;
      border: 1px solid #333;
      border-radius: 12px;
      width: 500px;
      max-width: 92vw;
      max-height: 88vh;
      overflow-y: auto;
      padding: 28px;
      animation: modal-in 0.15s ease;
    }

    @keyframes modal-in {
      from { opacity: 0; transform: translateY(10px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 22px;
    }

    .modal-title {
      font-size: 15px;
      font-weight: 600;
      color: var(--text);
    }

    .modal-close {
      width: 26px; height: 26px;
      display: flex; align-items: center; justify-content: center;
      border-radius: 5px; cursor: pointer;
      color: var(--muted); font-size: 14px;
      transition: all 0.1s;
    }
    .modal-close:hover { background: var(--hover); color: var(--text); }

    .modal-type-tabs {
      display: flex; gap: 4px;
      background: var(--surface);
      border-radius: 8px; padding: 4px;
      margin-bottom: 24px;
    }

    .modal-tab {
      flex: 1; padding: 6px 4px;
      border: none; background: transparent;
      border-radius: 5px;
      font-family: inherit; font-size: 11px; font-weight: 500;
      color: var(--muted); cursor: pointer;
      transition: all 0.15s; text-align: center;
    }
    .modal-tab:hover { color: var(--text); }
    .modal-tab.active { background: #2e2e2e; color: var(--text); }

    .modal-form { display: none; }
    .modal-form.active { display: block; }

    .form-group { margin-bottom: 16px; }
    .form-group label {
      display: block;
      font-size: 10.5px; font-weight: 600;
      letter-spacing: 0.07em; text-transform: uppercase;
      color: var(--muted); margin-bottom: 7px;
    }
    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 7px;
      padding: 9px 12px;
      font-family: inherit; font-size: 13px;
      color: var(--text); outline: none;
      transition: border-color 0.15s;
      resize: vertical;
    }
    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus { border-color: #3a3a3a; }
    .form-group select { cursor: pointer; }
    .form-group input::placeholder,
    .form-group textarea::placeholder { color: #555; }

    .upload-area {
      border: 1px dashed #3a3a3a;
      border-radius: 10px;
      padding: 40px 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.15s;
      color: var(--muted); font-size: 13px;
    }
    .upload-area:hover { border-color: #555; background: rgba(255,255,255,0.02); }
    .upload-area .upload-icon { font-size: 34px; margin-bottom: 10px; }
    .upload-area .upload-sub { font-size: 11px; margin-top: 5px; opacity: 0.55; }

    .modal-actions {
      display: flex; justify-content: flex-end; gap: 8px;
      margin-top: 24px; padding-top: 20px;
      border-top: 1px solid var(--border);
    }

    /* Sidebar add (+) button */
    .item-add {
      width: 18px; height: 18px;
      display: flex; align-items: center; justify-content: center;
      border-radius: 4px;
      font-size: 15px; line-height: 1;
      color: var(--muted);
      opacity: 0;
      transition: all 0.1s;
      margin-right: 2px;
    }
    .sidebar-item:hover .item-add { opacity: 1; }
    .item-add:hover { color: var(--text) !important; background: #3a3a3a; }

    /* ─── POST DETAIL ──────────────────────────────── */
    .post-detail-meta {
      display: flex; align-items: center; gap: 10px;
      margin-bottom: 20px;
    }

    .post-detail-body {
      max-width: 580px;
      font-size: 14px; line-height: 1.85;
      color: #ccc9c4;
      white-space: pre-wrap;
      margin-bottom: 36px;
    }

    .post-detail-actions {
      display: flex; align-items: center; gap: 8px;
    }

    /* ─── BATCH STUDIO ────────────────────────────── */
    #view-batch { padding: 0; }

    /* Config area */
    .batch-config {
      padding: 24px 28px 20px;
      border-bottom: 1px solid var(--border);
      background: var(--sidebar);
      flex-shrink: 0;
    }

    .config-label {
      font-size: 10px;
      font-weight: 600;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--muted);
      margin-bottom: 12px;
    }

    /* Type cards */
    .type-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      margin-bottom: 20px;
    }

    .type-card {
      position: relative;
      background: var(--surface);
      border: 1.5px solid var(--border);
      border-radius: 10px;
      padding: 14px 16px;
      cursor: pointer;
      transition: all 0.15s;
      user-select: none;
    }

    .type-card:hover { border-color: #3a3a3a; background: var(--hover); }

    .type-card.active {
      border-color: rgba(201,169,110,0.7);
      background: rgba(201,169,110,0.05);
    }

    .type-card-check {
      position: absolute;
      top: 10px; right: 10px;
      width: 18px; height: 18px;
      background: var(--gold);
      border-radius: 50%;
      display: none;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      color: #1a1610;
      font-weight: 700;
    }

    .type-card.active .type-card-check { display: flex; }

    .type-card-icon { font-size: 20px; margin-bottom: 8px; }

    .type-card-platform {
      font-size: 10px;
      font-weight: 600;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: var(--muted);
      margin-bottom: 3px;
    }

    .type-card-name {
      font-size: 13px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 6px;
    }

    .type-card-fields {
      font-size: 10.5px;
      color: var(--muted);
      line-height: 1.5;
    }

    /* Settings row */
    .config-row {
      display: flex;
      align-items: flex-end;
      gap: 16px;
      flex-wrap: wrap;
    }

    .config-row .config-group { display: flex; flex-direction: column; gap: 8px; }

    /* Source chips */
    .source-chips {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    .source-chip {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 5px 10px;
      border: 1px solid var(--border);
      border-radius: 20px;
      font-size: 11.5px;
      color: var(--muted);
      cursor: pointer;
      transition: all 0.12s;
      user-select: none;
    }

    .source-chip input { display: none; }

    .source-chip:hover { border-color: #3a3a3a; color: var(--text); }

    .source-chip.checked {
      border-color: rgba(201,169,110,0.5);
      color: var(--gold);
      background: rgba(201,169,110,0.06);
    }

    .config-select {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 7px;
      padding: 7px 28px 7px 12px;
      font-family: inherit;
      font-size: 12.5px;
      color: var(--text);
      outline: none;
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'%3E%3Cpath fill='%239a9792' d='M0 0l5 6 5-6z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 10px center;
    }
    .config-select option { background: #252525; }

    .batch-generate-btn {
      display: inline-flex;
      align-items: center;
      gap: 7px;
      padding: 9px 22px;
      background: var(--gold);
      color: #1a1610;
      border: none;
      border-radius: 8px;
      font-family: inherit;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.15s;
      margin-left: auto;
      white-space: nowrap;
    }
    .batch-generate-btn:hover { background: #d4b580; }

    /* Empty state */
    .batch-empty {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 80px 20px;
      color: var(--muted);
      text-align: center;
      gap: 12px;
    }

    .batch-empty-icon { font-size: 40px; opacity: 0.4; }
    .batch-empty-title { font-size: 14px; color: var(--text); font-weight: 500; }
    .batch-empty-sub { font-size: 12.5px; max-width: 300px; line-height: 1.6; }

    /* Grid */
    .batch-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
      gap: 14px;
      padding: 20px 28px 28px;
    }

    .batch-card {
      background: var(--surface);
      border: 1.5px solid var(--border);
      border-radius: 10px;
      display: flex;
      flex-direction: column;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    .batch-card.selected {
      border-color: rgba(201,169,110,0.6);
      box-shadow: 0 0 0 3px rgba(201,169,110,0.07);
    }

    .batch-card-header {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 11px 14px;
      border-bottom: 1px solid var(--border);
      flex-shrink: 0;
    }

    .batch-card-num {
      font-size: 10px;
      font-weight: 600;
      color: var(--muted);
      background: var(--hover);
      border-radius: 4px;
      padding: 2px 6px;
    }

    .batch-card-type {
      font-size: 11px;
      color: var(--muted);
      flex: 1;
    }

    .batch-check {
      width: 15px; height: 15px;
      cursor: pointer;
      accent-color: var(--gold);
      flex-shrink: 0;
    }

    .batch-card-body {
      flex: 1;
      padding: 14px 16px;
      font-size: 12.5px;
      line-height: 1.75;
      color: var(--text);
      white-space: pre-wrap;
      outline: none;
      min-height: 220px;
      max-height: 320px;
      overflow-y: auto;
      cursor: text;
      word-break: break-word;
    }
    .batch-card-body:focus { background: rgba(255,255,255,0.012); }

    .batch-card-footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 9px 14px;
      border-top: 1px solid var(--border);
      flex-shrink: 0;
    }

    .batch-char-count {
      font-size: 10.5px;
      color: var(--muted);
      font-variant-numeric: tabular-nums;
    }
    .batch-char-count.over { color: #e07070; }

    /* Export bar */
    .batch-export-bar {
      display: none;
      align-items: center;
      justify-content: space-between;
      padding: 13px 28px;
      border-top: 1px solid var(--border);
      background: #1c1c1c;
      flex-shrink: 0;
    }
    .batch-export-bar.visible { display: flex; }

    .batch-selected-text { font-size: 13px; color: var(--muted); }
    .batch-selected-text strong { color: var(--gold); font-variant-numeric: tabular-nums; }
    .batch-export-actions { display: flex; gap: 8px; }

    /* ─── ÖVERSIKT ────────────────────────────────────── */
    .dash-stats {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
      margin-bottom: 24px;
    }
    .dash-stat {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 18px 20px;
    }
    .dash-stat-value {
      font-size: 30px;
      font-weight: 700;
      color: var(--text);
      letter-spacing: -1px;
      margin-bottom: 3px;
      line-height: 1;
    }
    .dash-stat-label { font-size: 11.5px; color: var(--muted); }
    .dash-stat-change { font-size: 11px; color: #6dbf7e; margin-top: 5px; }
    .dash-stat-change.neutral { color: var(--muted); }
    .dash-grid {
      display: grid;
      grid-template-columns: 1fr 280px;
      gap: 16px;
    }
    .dash-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 16px;
    }
    .dash-card:last-child { margin-bottom: 0; }
    .dash-card-title {
      font-size: 10.5px;
      font-weight: 600;
      letter-spacing: 0.07em;
      text-transform: uppercase;
      color: var(--muted);
      padding: 12px 16px;
      border-bottom: 1px solid var(--border);
    }
    .activity-item {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 10px 16px;
      border-bottom: 1px solid var(--border);
      font-size: 12.5px;
    }
    .activity-item:last-child { border-bottom: none; }
    .activity-dot {
      width: 7px; height: 7px;
      border-radius: 50%;
      background: var(--muted);
      margin-top: 5px;
      flex-shrink: 0;
    }
    .activity-dot.gold { background: var(--gold); }
    .activity-dot.green { background: #6dbf7e; }
    .activity-dot.blue { background: var(--linkedin); }
    .activity-text { flex: 1; color: var(--text); line-height: 1.4; }
    .activity-time { font-size: 11px; color: var(--muted); white-space: nowrap; }
    .quick-action {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      border-bottom: 1px solid var(--border);
      cursor: pointer;
      transition: background 0.1s;
    }
    .quick-action:last-child { border-bottom: none; }
    .quick-action:hover { background: var(--hover); }
    .quick-action-icon { font-size: 18px; flex-shrink: 0; }
    .quick-action-label { font-size: 12.5px; font-weight: 500; color: var(--text); }
    .quick-action-sub { font-size: 11px; color: var(--muted); margin-top: 1px; }

    /* ─── PIPELINE ─────────────────────────────────────── */
    .pipeline-board {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
      margin-top: 20px;
    }
    .pipeline-col {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      overflow: hidden;
    }
    .pipeline-col-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 14px;
      border-bottom: 1px solid var(--border);
    }
    .pipeline-col-title {
      font-size: 10.5px;
      font-weight: 600;
      letter-spacing: 0.07em;
      text-transform: uppercase;
      color: var(--muted);
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .pipeline-col-dot { width: 7px; height: 7px; border-radius: 50%; flex-shrink: 0; }
    .pipeline-col-count {
      font-size: 11px;
      color: var(--muted);
      background: var(--hover);
      border-radius: 4px;
      padding: 1px 7px;
    }
    .pipeline-cards { padding: 10px; display: flex; flex-direction: column; gap: 8px; }
    .pipe-card {
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 7px;
      padding: 11px 13px;
      transition: all 0.12s;
    }
    .pipe-card:hover { border-color: #3a3a3a; }
    .pipe-card-title {
      font-size: 12.5px;
      font-weight: 500;
      color: var(--text);
      margin-bottom: 7px;
      line-height: 1.35;
    }
    .pipe-card-meta {
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
    }
    .pipe-card-date { font-size: 11px; color: var(--muted); }
    .pipe-move-btn {
      display: inline-flex;
      align-items: center;
      font-size: 10.5px;
      color: var(--muted);
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 2px 7px;
      cursor: pointer;
      margin-left: auto;
      transition: all 0.1s;
      font-family: inherit;
    }
    .pipe-move-btn:hover { color: var(--gold); border-color: rgba(201,169,110,0.4); }

    /* ─── KALENDER ─────────────────────────────────────── */
    .cal-header-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
    }
    .cal-nav { display: flex; align-items: center; gap: 12px; }
    .cal-nav-btn {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 6px;
      width: 28px; height: 28px;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; color: var(--muted); font-size: 14px; transition: all 0.1s;
    }
    .cal-nav-btn:hover { background: var(--hover); color: var(--text); }
    .cal-month { font-size: 16px; font-weight: 600; color: var(--text); }
    .cal-legend { display: flex; align-items: center; gap: 14px; }
    .cal-legend-item { display: flex; align-items: center; gap: 5px; font-size: 11px; color: var(--muted); }
    .cal-legend-dot { width: 8px; height: 8px; border-radius: 50%; }
    .cal-weekdays {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      border-bottom: 1px solid var(--border);
      margin-bottom: 1px;
    }
    .cal-weekday {
      padding: 8px 0;
      font-size: 10px;
      font-weight: 600;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: var(--muted);
      text-align: center;
    }
    .cal-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      border: 1px solid var(--border);
      border-radius: 8px;
      overflow: hidden;
    }
    .cal-day {
      min-height: 90px;
      padding: 7px;
      border-right: 1px solid var(--border);
      border-bottom: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      gap: 3px;
    }
    .cal-day:nth-child(7n) { border-right: none; }
    .cal-day.last-row { border-bottom: none; }
    .cal-day.other-month .cal-day-num { opacity: 0.35; }
    .cal-day.today .cal-day-num {
      background: var(--gold);
      color: #1a1610;
      border-radius: 50%;
    }
    .cal-day-num {
      width: 22px; height: 22px;
      display: flex; align-items: center; justify-content: center;
      font-size: 11px; font-weight: 500;
      color: var(--muted); flex-shrink: 0; margin-bottom: 1px;
    }
    .cal-event {
      font-size: 10px;
      padding: 2px 5px;
      border-radius: 3px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      cursor: pointer;
    }
    .cal-event:hover { opacity: 0.8; }
    .cal-event.linkedin { background: rgba(91,143,222,0.2); color: var(--linkedin); }
    .cal-event.instagram { background: rgba(216,112,160,0.15); color: #d870a0; }
    .cal-event.event { background: rgba(201,169,110,0.15); color: var(--gold); }

    /* ─── SCROLLBARS ──────────────────────────────── */
    ::-webkit-scrollbar { width: 4px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: #333; border-radius: 2px; }
    ::-webkit-scrollbar-thumb:hover { background: #444; }

    /* ─── VIEWS ───────────────────────────────────── */
    .view { display: none; }
    .view.active { display: block; }

    /* ─── EVENT ───────────────────────────────────── */
    .event-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 18px 22px;
      margin-bottom: 12px;
      cursor: pointer;
      transition: all 0.15s;
      max-width: 640px;
    }
    .event-card:hover { background: var(--hover); border-color: #363636; }

    .event-card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .event-card-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 4px;
    }

    .event-meta {
      font-size: 12px;
      color: var(--muted);
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .event-badge {
      display: inline-flex;
      align-items: center;
      font-size: 11px;
      font-weight: 500;
      padding: 3px 9px;
      border-radius: 4px;
    }
    .event-badge.planering {
      background: rgba(201,169,110,0.15);
      color: var(--gold);
    }
    .event-badge.bekraftat {
      background: rgba(109,191,126,0.15);
      color: #6dbf7e;
    }

    .event-guests {
      font-size: 12px;
      color: var(--muted);
    }

    .guest-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 12px;
      max-width: 640px;
    }
    .guest-table th {
      text-align: left;
      font-size: 10px;
      font-weight: 600;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: var(--muted);
      padding: 8px 12px;
      border-bottom: 1px solid var(--border);
    }
    .guest-table td {
      font-size: 12.5px;
      color: var(--text);
      padding: 10px 12px;
      border-bottom: 1px solid var(--border);
    }

    .guest-status {
      display: inline-flex;
      align-items: center;
      font-size: 11px;
      font-weight: 500;
      padding: 2px 8px;
      border-radius: 4px;
    }
    .guest-status.bjuden {
      background: rgba(91,143,222,0.15);
      color: var(--linkedin);
    }
    .guest-status.bekraftad {
      background: rgba(109,191,126,0.15);
      color: #6dbf7e;
    }
    .guest-status.tackat-nej {
      background: rgba(224,112,112,0.15);
      color: #e07070;
    }

    .checklist-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 0;
      font-size: 13px;
      color: var(--text);
      border-bottom: 1px solid var(--border);
    }
    .checklist-item input[type="checkbox"] {
      accent-color: var(--gold);
      width: 14px;
      height: 14px;
      cursor: pointer;
      flex-shrink: 0;
    }
    .checklist-item.done { color: var(--muted); text-decoration: line-through; }

    .event-summary {
      display: flex;
      gap: 10px;
      margin-bottom: 24px;
      flex-wrap: wrap;
    }
    .event-summary-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 14px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      font-size: 12px;
      color: var(--muted);
    }
    .event-summary-badge strong {
      color: var(--text);
      font-variant-numeric: tabular-nums;
    }

    .event-section-title {
      font-size: 15px;
      font-weight: 600;
      color: var(--text);
      margin: 28px 0 12px;
    }

    /* ─── DASHBOARD ──────────────────────────────────── */
    .dashboard-cards {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 14px;
      margin-bottom: 32px;
    }

    .dash-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 18px 20px;
      transition: all 0.15s;
    }
    .dash-card:hover { border-color: #363636; }

    .dash-card-icon { font-size: 20px; margin-bottom: 8px; }
    .dash-card-value {
      font-size: 22px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 4px;
    }
    .dash-card-label {
      font-size: 12px;
      color: var(--muted);
    }

    .activity-feed {
      max-width: 640px;
      margin-bottom: 32px;
    }

    .feed-item {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 12px 0;
      border-bottom: 1px solid var(--border);
      font-size: 13px;
      color: var(--text);
    }
    .feed-item-icon { font-size: 16px; flex-shrink: 0; margin-top: 1px; }
    .feed-item-time { font-size: 11px; color: var(--muted); margin-top: 3px; white-space: nowrap; }
    .feed-item-text { flex: 1; line-height: 1.5; }

    .mini-calendar {
      display: flex;
      gap: 8px;
      overflow-x: auto;
      padding-bottom: 8px;
      max-width: 640px;
    }
    .cal-day {
      min-width: 80px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 10px 12px;
      text-align: center;
      flex-shrink: 0;
    }
    .cal-day-name { font-size: 10px; font-weight: 600; text-transform: uppercase; color: var(--muted); margin-bottom: 4px; }
    .cal-day-num { font-size: 16px; font-weight: 600; color: var(--text); margin-bottom: 6px; }
    .cal-day-dot { width: 6px; height: 6px; border-radius: 50%; margin: 0 auto; }
    .cal-day-dot.gold { background: var(--gold); }
    .cal-day-dot.blue { background: var(--linkedin); }
    .cal-day.today { border-color: rgba(201,169,110,0.5); background: rgba(201,169,110,0.05); }

    /* ─── KONTAKTER ──────────────────────────────────── */
    .contact-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 14px;
      max-width: 900px;
    }
    .contact-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 18px 20px;
      cursor: pointer;
      transition: all 0.15s;
    }
    .contact-card:hover { background: var(--hover); border-color: #363636; }

    .contact-card-header { display: flex; align-items: center; gap: 12px; margin-bottom: 10px; }
    .contact-avatar {
      width: 36px; height: 36px;
      border-radius: 50%;
      background: var(--hover);
      display: flex; align-items: center; justify-content: center;
      font-size: 14px; font-weight: 600; color: var(--muted);
      flex-shrink: 0;
    }
    .contact-name { font-size: 14px; font-weight: 600; color: var(--text); }
    .contact-company { font-size: 12px; color: var(--muted); }

    .contact-tag {
      display: inline-flex;
      font-size: 10px;
      font-weight: 600;
      padding: 3px 8px;
      border-radius: 4px;
      margin-bottom: 8px;
    }
    .contact-tag.natverk { background: rgba(91,143,222,0.15); color: var(--linkedin); }
    .contact-tag.prospekt { background: rgba(201,169,110,0.15); color: var(--gold); }
    .contact-tag.kund { background: rgba(109,191,126,0.15); color: #6dbf7e; }

    .contact-last { font-size: 11px; color: var(--muted); }

    /* Pipeline */
    .pipeline {
      display: flex;
      gap: 16px;
      overflow-x: auto;
      padding-bottom: 12px;
    }
    .pipeline-col {
      min-width: 220px;
      flex: 1;
    }
    .pipeline-col-header {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: var(--muted);
      padding: 8px 12px;
      margin-bottom: 8px;
      border-bottom: 2px solid var(--border);
    }
    .pipeline-col-header.gold-border { border-color: var(--gold); }
    .pipeline-col-header.green-border { border-color: #6dbf7e; }
    .pipeline-col-header.blue-border { border-color: var(--linkedin); }

    .pipeline-item {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px 14px;
      margin-bottom: 8px;
      font-size: 13px;
      color: var(--text);
      cursor: pointer;
      transition: all 0.15s;
    }
    .pipeline-item:hover { background: var(--hover); }
    .pipeline-item-sub { font-size: 11px; color: var(--muted); margin-top: 4px; }

    /* ─── MÖTEN ──────────────────────────────────────── */
    .meeting-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 18px 22px;
      margin-bottom: 12px;
      cursor: pointer;
      transition: all 0.15s;
      max-width: 640px;
    }
    .meeting-card:hover { background: var(--hover); border-color: #363636; }

    .meeting-card-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 6px; }
    .meeting-date-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      font-weight: 500;
      color: var(--gold);
    }
    .meeting-type-badge {
      font-size: 10px;
      font-weight: 600;
      padding: 3px 8px;
      border-radius: 4px;
      background: rgba(201,169,110,0.15);
      color: var(--gold);
    }
    .meeting-card-title { font-size: 14px; font-weight: 600; color: var(--text); margin-bottom: 4px; }
    .meeting-card-participants { font-size: 12px; color: var(--muted); }

    /* ─── ERBJUDANDEN ────────────────────────────────── */
    .offer-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 18px 22px;
      margin-bottom: 12px;
      cursor: pointer;
      transition: all 0.15s;
      max-width: 640px;
    }
    .offer-card:hover { background: var(--hover); border-color: #363636; }

    .offer-card-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; }
    .offer-status {
      display: inline-flex;
      font-size: 11px;
      font-weight: 500;
      padding: 3px 9px;
      border-radius: 4px;
    }
    .offer-status.utkast { background: rgba(154,151,146,0.15); color: var(--muted); }
    .offer-status.skickad { background: rgba(91,143,222,0.15); color: var(--linkedin); }
    .offer-status.accepterad { background: rgba(109,191,126,0.15); color: #6dbf7e; }

    .offer-card-title { font-size: 14px; font-weight: 600; color: var(--text); margin-bottom: 4px; }
    .offer-card-meta { font-size: 12px; color: var(--muted); }
    .offer-amount { font-size: 13px; font-weight: 600; color: var(--gold); }

    /* ─── NYHETSBREV ─────────────────────────────────── */
    .newsletter-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 18px 22px;
      margin-bottom: 12px;
      cursor: pointer;
      transition: all 0.15s;
      max-width: 640px;
    }
    .newsletter-card:hover { background: var(--hover); border-color: #363636; }

    .newsletter-card-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 6px; }
    .newsletter-status {
      display: inline-flex;
      font-size: 11px;
      font-weight: 500;
      padding: 3px 9px;
      border-radius: 4px;
    }
    .newsletter-status.utkast { background: rgba(154,151,146,0.15); color: var(--muted); }
    .newsletter-status.planerad { background: rgba(201,169,110,0.15); color: var(--gold); }
    .newsletter-status.skickat { background: rgba(109,191,126,0.15); color: #6dbf7e; }

    .newsletter-card-title { font-size: 14px; font-weight: 600; color: var(--text); margin-bottom: 4px; }
    .newsletter-card-meta { font-size: 12px; color: var(--muted); }

    /* ─── UPPGIFTER ──────────────────────────────────── */
    .task-item {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 14px 16px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      margin-bottom: 8px;
      max-width: 640px;
      transition: all 0.15s;
    }
    .task-item:hover { background: var(--hover); }

    .task-checkbox {
      width: 18px; height: 18px;
      accent-color: var(--gold);
      cursor: pointer;
      flex-shrink: 0;
      margin-top: 1px;
    }
    .task-content { flex: 1; }
    .task-title { font-size: 13px; font-weight: 500; color: var(--text); margin-bottom: 4px; }
    .task-source { font-size: 11px; color: var(--muted); }

    .task-tag {
      display: inline-flex;
      font-size: 10px;
      font-weight: 500;
      padding: 2px 7px;
      border-radius: 3px;
      margin-left: 6px;
    }
    .task-tag.mote { background: rgba(201,169,110,0.15); color: var(--gold); }
    .task-tag.event { background: rgba(130,80,200,0.15); color: #a070d0; }
    .task-tag.offert { background: rgba(91,143,222,0.15); color: var(--linkedin); }
    .task-tag.content { background: rgba(109,191,126,0.15); color: #6dbf7e; }

    .task-priority {
      font-size: 10px;
      font-weight: 600;
      padding: 2px 7px;
      border-radius: 3px;
      flex-shrink: 0;
    }
    .task-priority.hog { background: rgba(224,112,112,0.15); color: #e07070; }
    .task-priority.medel { background: rgba(201,169,110,0.15); color: var(--gold); }
    .task-priority.lag { background: rgba(154,151,146,0.15); color: var(--muted); }

    /* ─── AI-TEAM ────────────────────────────────────── */
    .agent-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 14px;
    }
    .agent-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 20px 22px;
      transition: all 0.15s;
    }
    .agent-card:hover { border-color: #363636; }

    .agent-card-header { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
    .agent-icon { font-size: 24px; }
    .agent-name { font-size: 14px; font-weight: 600; color: var(--text); }
    .agent-role { font-size: 12px; color: var(--muted); }

    .agent-status {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      font-size: 11px;
      font-weight: 500;
      padding: 3px 9px;
      border-radius: 4px;
      margin-bottom: 10px;
    }
    .agent-status.aktiv { background: rgba(109,191,126,0.15); color: #6dbf7e; }
    .agent-status.pausad { background: rgba(154,151,146,0.15); color: var(--muted); }
    .agent-status-dot {
      width: 6px; height: 6px;
      border-radius: 50%;
    }
    .agent-status.aktiv .agent-status-dot { background: #6dbf7e; }
    .agent-status.pausad .agent-status-dot { background: var(--muted); }

    .agent-stats { font-size: 12px; color: var(--muted); margin-bottom: 10px; }
    .agent-stats strong { color: var(--text); }

    .agent-log {
      font-size: 11px;
      color: var(--muted);
      line-height: 1.6;
      border-top: 1px solid var(--border);
      padding-top: 10px;
    }
    .agent-log-item { padding: 3px 0; }
    .agent-log-time { color: #555; margin-right: 6px; }

    /* ─── FLOW CHAINS (Dashboard) ────────────────────── */
    .flow-chain {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 18px 22px;
      margin-bottom: 14px;
      max-width: 640px;
    }
    .flow-chain-title { font-size: 13px; font-weight: 600; color: var(--text); margin-bottom: 10px; }
    .flow-steps {
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
      font-size: 11px;
    }
    .flow-step {
      background: var(--hover);
      border: 1px solid var(--border);
      border-radius: 5px;
      padding: 4px 10px;
      color: var(--muted);
      white-space: nowrap;
    }
    .flow-step.active-step { border-color: rgba(201,169,110,0.5); color: var(--gold); background: rgba(201,169,110,0.05); }
    .flow-arrow { color: #444; font-size: 10px; }

    /* ─── SECTION TITLE REUSABLE ─────────────────────── */
    .section-title {
      font-size: 15px;
      font-weight: 600;
      color: var(--text);
      margin: 28px 0 12px;
    }
    .section-title:first-child { margin-top: 0; }
  </style>
</head>
<body>

<!-- ═══ SIDEBAR ════════════════════════════════════ -->
<aside class="sidebar">
  <div class="sidebar-logo">
    <div class="logo-mark">C</div>
    Cefund Studio
  </div>

  <div class="sidebar-search">
    <span class="search-icon">🔍</span>
    <input type="text" placeholder="Sök..." oninput="searchSidebar(this.value)" />
  </div>

  <!-- ÖVERSIKT -->
  <div class="sidebar-section">
    <div class="sidebar-section-label">📊 Översikt</div>
    <div class="sidebar-item" onclick="showNewView('dashboard')">
      <span class="item-icon">🏠</span>
      <span class="item-text">Dashboard</span>
    </div>
  </div>

  <div class="sidebar-divider"></div>

  <!-- KONTAKTER -->
  <div class="sidebar-section">
    <div class="sidebar-section-label">👥 Kontakter</div>
    <div class="sidebar-item" onclick="showNewView('contacts')">
      <span class="item-icon">📇</span>
      <span class="item-text">Alla kontakter</span>
    </div>
    <div class="sidebar-item" onclick="showNewView('pipeline')">
      <span class="item-icon">📊</span>
      <span class="item-text">Pipeline</span>
    </div>
  </div>

  <div class="sidebar-divider"></div>

  <!-- MÖTEN -->
  <div class="sidebar-section">
    <div class="sidebar-section-label">📅 Möten</div>
    <div class="sidebar-item" onclick="showNewView('meetings')">
      <span class="item-icon">📅</span>
      <span class="item-text">Kommande möten</span>
    </div>
    <div class="sidebar-item" onclick="showNewView('meeting-notes')">
      <span class="item-icon">📝</span>
      <span class="item-text">Mötesanteckningar</span>
    </div>
  </div>

  <div class="sidebar-divider"></div>

  <!-- ERBJUDANDEN -->
  <div class="sidebar-section">
    <div class="sidebar-section-label">📄 Erbjudanden</div>
    <div class="sidebar-item" onclick="showNewView('offers')">
      <span class="item-icon">💼</span>
      <span class="item-text">Aktiva offerter</span>
    </div>
    <div class="sidebar-item" onclick="showNewView('offer-templates')">
      <span class="item-icon">📋</span>
      <span class="item-text">Mallar</span>
    </div>
  </div>

  <div class="sidebar-divider"></div>

  <!-- CONTENT (befintligt) -->
  <div class="sidebar-section">
    <div class="sidebar-section-label">✍️ Content</div>

    <div class="sidebar-item" onclick="toggleSection('kallbibliotek-nav', this)">
      <span class="item-icon">📚</span>
      <span class="item-text">Källbibliotek</span>
      <span class="item-arrow">›</span>
    </div>
    <div class="sidebar-sub" id="kallbibliotek-nav">
      <div class="sidebar-sub-item active" onclick="showDoc('investering', this)">Investerardag feb 2026</div>
      <div class="sidebar-sub-item" onclick="showDoc('kund', this)">Kundpresentation Q1 2026</div>
      <div class="sidebar-sub-item" onclick="showDoc('marknad', this)">Marknadskommentarer feb</div>
      <div class="sidebar-sub-item" onclick="showDoc('team', this)">Teamets bakgrund</div>
      <div class="sidebar-sub-item" onclick="showDoc('hemsida', this)">cefund.se</div>
    </div>

    <div class="sidebar-item" onclick="toggleSection('posts-nav', this); showView('posts')">
      <span class="item-icon">📝</span>
      <span class="item-text">Inlägg</span>
      <span class="item-arrow">›</span>
    </div>
    <div class="sidebar-sub" id="posts-nav">
      <div class="sidebar-sub-item" onclick="filterPosts('linkedin', this)">LinkedIn</div>
      <div class="sidebar-sub-item" onclick="filterPosts('instagram', this)">Instagram</div>
    </div>

    <div class="sidebar-item" onclick="toggleSection('studio-nav', this)">
      <span class="item-icon">✨</span>
      <span class="item-text">Studio</span>
      <span class="item-arrow">›</span>
    </div>
    <div class="sidebar-sub" id="studio-nav">
      <div class="sidebar-sub-item" onclick="togglePanel(); showView('doc')">Generera inlägg</div>
      <div class="sidebar-sub-item" onclick="showBatch()">Generera flera</div>
      <div class="sidebar-sub-item" onclick="showView('published')">Publicerat</div>
    </div>
  </div>

  <div class="sidebar-divider"></div>

  <!-- NYHETSBREV -->
  <div class="sidebar-section">
    <div class="sidebar-section-label">📰 Nyhetsbrev</div>
    <div class="sidebar-item" onclick="showNewView('newsletter-drafts')">
      <span class="item-icon">✏️</span>
      <span class="item-text">Utkast</span>
    </div>
    <div class="sidebar-item" onclick="showNewView('newsletter-subscribers')">
      <span class="item-icon">👥</span>
      <span class="item-text">Prenumeranter</span>
    </div>
  </div>

  <div class="sidebar-divider"></div>

  <!-- EVENT (befintligt) -->
  <div class="sidebar-section">
    <div class="sidebar-section-label">🎉 Event</div>

    <div class="sidebar-item" onclick="toggleSection('event-kommande', this); showEvents()">
      <span class="item-icon">📅</span>
      <span class="item-text">Kommande event</span>
      <span class="item-arrow">›</span>
    </div>
    <div class="sidebar-sub" id="event-kommande">
      <div class="sidebar-sub-item" onclick="showEvent('varmingel', this)">Vårmingel 15 mars</div>
      <div class="sidebar-sub-item" onclick="showEvent('kundevent', this)">Kundevent april</div>
    </div>

    <div class="sidebar-item" onclick="toggleSection('event-gastlistor', this)">
      <span class="item-icon">🎟️</span>
      <span class="item-text">Gästlistor</span>
      <span class="item-arrow">›</span>
    </div>
    <div class="sidebar-sub" id="event-gastlistor">
      <div class="sidebar-sub-item" onclick="showGuestlist('varmingel', this)">Vårmingel 15 mars</div>
      <div class="sidebar-sub-item" onclick="showGuestlist('kundevent', this)">Kundevent april</div>
    </div>

    <div class="sidebar-item" onclick="showView('events-archive')">
      <span class="item-icon">📁</span>
      <span class="item-text">Tidigare event</span>
    </div>
  </div>

  <div class="sidebar-divider"></div>

  <!-- UPPGIFTER -->
  <div class="sidebar-section">
    <div class="sidebar-section-label">✅ Uppgifter</div>
    <div class="sidebar-item" onclick="showNewView('tasks-today')">
      <span class="item-icon">📌</span>
      <span class="item-text">Idag</span>
    </div>
    <div class="sidebar-item" onclick="showNewView('tasks-week')">
      <span class="item-icon">📅</span>
      <span class="item-text">Denna vecka</span>
    </div>
  </div>

  <div class="sidebar-divider"></div>

  <!-- AI-TEAM -->
  <div class="sidebar-section">
    <div class="sidebar-section-label">🤖 AI-Team</div>
    <div class="sidebar-item" onclick="showNewView('ai-agents')">
      <span class="item-icon">🤖</span>
      <span class="item-text">Agenter</span>
    </div>
    <div class="sidebar-item" onclick="showNewView('ai-log')">
      <span class="item-icon">📋</span>
      <span class="item-text">Aktivitetslogg</span>
    </div>
  </div>
</aside>

<!-- ═══ MAIN CONTENT ═════════════════════════════════ -->
<main class="main">
  <div class="main-topbar">
    <div class="breadcrumb" id="breadcrumb">
      <span class="crumb">Transkript</span>
      <span class="sep">›</span>
      <span class="crumb current">Investerardag feb 2026</span>
    </div>
    <div class="topbar-actions">
      <button class="btn btn-ghost" onclick="togglePanel()">✨ Generera</button>
    </div>
  </div>

  <div class="main-content">

    <!-- DOC: Investeringsfilosofi -->
    <div class="view active" id="view-investering">
      <span class="doc-icon">📗</span>
      <h1 class="doc-title">Investeringsfilosofi</h1>
      <div class="doc-meta">
        <span>Lagt till 12 feb 2026</span>
        <span class="dot">●</span>
        <span>3 sidor</span>
        <span class="dot">●</span>
        <span>Råmaterial</span>
      </div>
      <hr class="doc-divider" />
      <div class="doc-body">
        <p>Cefund är grundat på en enkel övertygelse: att oberoende rådgivning ger bättre resultat för privatpersoner och företagare än råd som styrs av provision.</p>
        <h2>Vår filosofi</h2>
        <p>Vi tror att långsiktig förmögenhetsbyggnad handlar om tre saker: tid i marknaden snarare än market timing, bred diversifiering, och minimering av kostnader och skatt. Det låter enkelt — men det svåra är att hålla fast vid det när omvärlden skrämmer.</p>
        <blockquote>
          "Det bästa investeringsbeslutet du kan fatta är att inte fatta ett beslut i panik."
        </blockquote>
        <h3>Oberoende som affärsmodell</h3>
        <p>Cefund tar betalt av kunderna — inte av produktbolagen. Det innebär att vår rådgivning inte påverkas av provisioner eller kickbacks. Vi rekommenderar det som är bäst för kunden, inte det som är bäst för vår plånbok.</p>
        <h3>Vad vi hjälper med</h3>
        <p>Pensionsplanering, kapitalallokering, fastighetsfinansiering, bolagsstruktur för ägare — och framförallt: att hålla en röd tråd genom alla delar av ekonomin så att de samverkar istället för motverkar varandra.</p>
        <p>Många av våra kunder är företagare som länge skjutit upp frågan om hur pengarna i bolaget egentligen ska jobba. Vi hjälper dem att gå från idé till faktisk struktur — utan att det ska krävas en examen i finansiell ekonomi.</p>
      </div>
      <button class="doc-source-btn" onclick="togglePanel()">
        ✨ Generera inlägg från detta källmaterial
      </button>
    </div>

    <!-- DOC: Kundberättelser -->
    <div class="view" id="view-kund">
      <span class="doc-icon">👥</span>
      <h1 class="doc-title">Kundberättelser</h1>
      <div class="doc-meta">
        <span>Lagt till 3 feb 2026</span>
        <span class="dot">●</span>
        <span>5 sidor</span>
        <span class="dot">●</span>
        <span>Råmaterial</span>
      </div>
      <hr class="doc-divider" />
      <div class="doc-body">
        <p>Berättelser från kunder som gått igenom en strukturerad finansiell genomlysning med Cefund.</p>
        <h2>Maria, 42, konsultchef</h2>
        <p>Maria hade sparpengar utspridda på sju olika konton och fonder, utan en tydlig strategi. Efter en genomlysning konsoliderade vi allt till tre depåer med tydliga syften: buffert, pension och aktiv tillväxt.</p>
        <blockquote>"Jag visste egentligen inte vad jag ägde. Nu vet jag exakt varför varje krona sitter där den sitter."</blockquote>
        <h2>Erik &amp; Johanna, 38 resp. 36, delägare i konsultbolag</h2>
        <p>Paret hade länge diskuterat att "göra något med pengarna i bolaget" men aldrig kommit till handling. Vi hjälpte dem sätta upp en kapitalförsäkring i bolaget och en gemensam pensionsplan som koordinerar deras respektive uttag.</p>
      </div>
      <button class="doc-source-btn" onclick="togglePanel()">
        ✨ Generera inlägg från detta källmaterial
      </button>
    </div>

    <!-- DOC: Marknadskommentarer -->
    <div class="view" id="view-marknad">
      <span class="doc-icon">📈</span>
      <h1 class="doc-title">Marknadskommentarer</h1>
      <div class="doc-meta">
        <span>Lagt till 18 feb 2026</span>
        <span class="dot">●</span>
        <span>2 sidor</span>
        <span class="dot">●</span>
        <span>Råmaterial</span>
      </div>
      <hr class="doc-divider" />
      <div class="doc-body">
        <p>Löpande marknadskommentarer som underlag för sociala medier och nyhetsbrev.</p>
        <h2>Februari 2026</h2>
        <p>Stockholmsbörsen har inlett 2026 med en tveksam start — OMXS30 är ned 3,2 % sedan årets början, drivet av oro kring inflationsutvecklingen i Europa och ett starkare värde på kronan.</p>
        <p>Vår syn är oförändrad: kortsiktig volatilitet är priset man betalar för långsiktig avkastning. Kunder med horisont bortom 5 år bör inte förändra sin allokering baserat på rörelserna i januari–februari.</p>
        <h3>Råvaror och räntor</h3>
        <p>Riksbanken signalerade vid senaste mötet att en ytterligare räntesänkning är möjlig under Q1. Det gynnar befintliga räntebärande innehav och gör fastighetssegmentet mer attraktivt igen.</p>
      </div>
      <button class="doc-source-btn" onclick="togglePanel()">
        ✨ Generera inlägg från detta källmaterial
      </button>
    </div>

    <!-- DOC: Teamets bakgrund -->
    <div class="view" id="view-team">
      <span class="doc-icon">🤝</span>
      <h1 class="doc-title">Teamets bakgrund</h1>
      <div class="doc-meta">
        <span>Lagt till 28 jan 2026</span>
        <span class="dot">●</span>
        <span>1 sida</span>
        <span class="dot">●</span>
        <span>Råmaterial</span>
      </div>
      <hr class="doc-divider" />
      <div class="doc-body">
        <p>Cefund grundades 2021 av tre rådgivare som lämnade storbanken bakom sig med en gemensam frustration: att provision-drivna modeller fundamentalt snedvrider incitamenten bort från kunden.</p>
        <h2>Grundarteamet</h2>
        <p><strong>Anders Lindgren</strong> — 18 år inom private banking, specialiserad på förmögenhetsplanering för familjer och ägare. Certifierad finansiell planerare (CFP).</p>
        <p><strong>Sara Östberg</strong> — Bakgrund inom skatteplanering och bolagsstruktur. Jurist med fördjupning i kapitalförvaltningsrätt.</p>
        <p><strong>Jonas Ekström</strong> — Portföljförvaltare med fokus på indexnära strategier och kostnadstransparens. Tidigare fondförvaltare på Swedbank Robur.</p>
      </div>
      <button class="doc-source-btn" onclick="togglePanel()">
        ✨ Generera inlägg från detta källmaterial
      </button>
    </div>

    <!-- DOC: Hemsida -->
    <div class="view" id="view-hemsida">
      <span class="doc-icon">🌐</span>
      <h1 class="doc-title">cefund.se</h1>
      <div class="doc-meta">
        <span>Synkad 19 feb 2026</span>
        <span class="dot">●</span>
        <span>Hemsida</span>
      </div>
      <hr class="doc-divider" />
      <div class="doc-body">
        <p>Hemsidans innehåll importerat som källmaterial. Används för att generera inlägg som är konsekventa med varumärket och hemsidans budskap.</p>
        <h2>Tagline</h2>
        <p><em>"Oberoende rådgivning. Ditt bästa intresse, alltid."</em></p>
        <h2>Tjänster (från hemsidan)</h2>
        <p>Helhetssyn på privatekonomin · Pensionsplanering · Bolagsstruktur &amp; utdelning · Fastighetsfinansiering · Generationsskifte</p>
        <h2>Om oss (kort)</h2>
        <p>Vi är en oberoende finansiell rådgivare baserad i Stockholm. Vi tar betalt av dig — inte av banker eller produktbolag. Sedan 2021 har vi hjälpt över 200 familjer och företagare att ta kontroll över sin ekonomi.</p>
      </div>
      <button class="doc-source-btn" onclick="togglePanel()">
        ✨ Generera inlägg från detta källmaterial
      </button>
    </div>

    <!-- POSTS VIEW -->
    <div class="view" id="view-posts">
      <h1 class="doc-title" style="margin-bottom: 6px;">Inlägg</h1>
      <div class="doc-meta" style="margin-bottom: 28px;">4 inlägg · LinkedIn &amp; Instagram</div>

      <div class="post-card" onclick="showPostDetail(0)">
        <div class="post-card-header">
          <span class="post-platform linkedin">💼 LinkedIn</span>
          <span class="post-date">14 feb 2026</span>
        </div>
        <div class="post-card-title">Varför oberoende rådgivning ger bättre resultat</div>
        <div class="post-card-preview">De flesta råd du får om din ekonomi kommer från någon som tjänar pengar på att du köper en viss produkt. Det är inte ett anklagande — det är systemet. Men det är viktigt att förstå hur det påverkar rådet du får...</div>
      </div>

      <div class="post-card" onclick="showPostDetail(1)">
        <div class="post-card-header">
          <span class="post-platform instagram">📸 Instagram</span>
          <span class="post-date">11 feb 2026</span>
        </div>
        <div class="post-card-title">3 saker du borde göra med ditt bolags överskott</div>
        <div class="post-card-preview">Har du pengar som "väntar" i ditt bolag utan att göra nytta? Du är inte ensam. Här är de tre vanligaste misstagen — och vad du kan göra istället 👇</div>
      </div>

      <div class="post-card" onclick="showPostDetail(2)">
        <div class="post-card-header">
          <span class="post-platform linkedin">💼 LinkedIn</span>
          <span class="post-date">5 feb 2026</span>
        </div>
        <div class="post-card-title">Riksbankens signaler — vad betyder det för dig?</div>
        <div class="post-card-preview">Riksbanken signalerade vid senaste mötet att ytterligare räntesänkningar kan komma under Q1. Det kan låta som en nyhet för makroekonomer — men det har konkreta konsekvenser för dig som privatperson...</div>
      </div>

      <div class="post-card" onclick="showPostDetail(3)">
        <div class="post-card-header">
          <span class="post-platform instagram">📸 Instagram</span>
          <span class="post-date">28 jan 2026</span>
        </div>
        <div class="post-card-title">Pensionssparande: det du inte visste att du inte visste</div>
        <div class="post-card-preview">Visste du att valet av fonder i ditt tjänstepension kan skilja hundratusentals kronor vid pensionering — med exakt samma insättningar? Det handlar om avgifter och allokering...</div>
      </div>
    </div>

    <!-- BATCH VIEW -->
    <div class="view" id="view-batch">

      <div class="batch-config">

        <!-- Steg 1: Välj innehållstyp -->
        <div class="config-label">Välj innehållstyp</div>
        <div class="type-grid">

          <div class="type-card active" data-type="linkedin-tankeled" onclick="selectType('linkedin-tankeled', this)">
            <div class="type-card-check">✓</div>
            <div class="type-card-icon">💼</div>
            <div class="type-card-platform">LinkedIn</div>
            <div class="type-card-name">Tankeledare</div>
            <div class="type-card-fields">Hook · Brödtext · Hashtags</div>
          </div>

          <div class="type-card" data-type="linkedin-tips" onclick="selectType('linkedin-tips', this)">
            <div class="type-card-check">✓</div>
            <div class="type-card-icon">💼</div>
            <div class="type-card-platform">LinkedIn</div>
            <div class="type-card-name">Tipslista</div>
            <div class="type-card-fields">Rubrik · Tips 1–3 · Hashtags</div>
          </div>

          <div class="type-card" data-type="ig-quote" onclick="selectType('ig-quote', this)">
            <div class="type-card-check">✓</div>
            <div class="type-card-icon">📸</div>
            <div class="type-card-platform">Instagram</div>
            <div class="type-card-name">Quote</div>
            <div class="type-card-fields">Citat · Byline</div>
          </div>

          <div class="type-card" data-type="ig-karusell" onclick="selectType('ig-karusell', this)">
            <div class="type-card-check">✓</div>
            <div class="type-card-icon">📸</div>
            <div class="type-card-platform">Instagram</div>
            <div class="type-card-name">Karusell</div>
            <div class="type-card-fields">Bild 1–4 · Hashtags</div>
          </div>

        </div>

        <!-- Steg 2: Inställningar + generera -->
        <div class="config-row">

          <div class="config-group">
            <div class="config-label">Källor</div>
            <div class="source-chips">
              <label class="source-chip checked" onclick="toggleChip(this)"><input type="checkbox" checked />Investeringsfilosofi</label>
              <label class="source-chip checked" onclick="toggleChip(this)"><input type="checkbox" checked />Kundberättelser</label>
              <label class="source-chip" onclick="toggleChip(this)"><input type="checkbox" />Marknadskommentarer</label>
              <label class="source-chip" onclick="toggleChip(this)"><input type="checkbox" />Teamets bakgrund</label>
              <label class="source-chip" onclick="toggleChip(this)"><input type="checkbox" />cefund.se</label>
            </div>
          </div>

          <div class="config-group">
            <div class="config-label">Tonläge</div>
            <select class="config-select">
              <option>Pedagogisk</option>
              <option>Personlig &amp; varm</option>
              <option>Professionell</option>
              <option>Provocerande</option>
              <option>Berättande</option>
            </select>
          </div>

          <button class="batch-generate-btn" onclick="batchGenerate()">✨ Generera 7 inlägg</button>

        </div>
      </div>

      <!-- Steg 3: Inlägg -->
      <div id="batch-grid-wrap">
        <div class="batch-empty" id="batch-empty">
          <div class="batch-empty-icon">⚡</div>
          <div class="batch-empty-title">Inga inlägg genererade ännu</div>
          <div class="batch-empty-sub">Välj en innehållstyp och källmaterial, klicka sedan på Generera 7 inlägg.</div>
        </div>
        <div class="batch-grid" id="batch-grid" style="display:none;"></div>
      </div>

    </div>

    <!-- POST DETAIL VIEW -->
    <div class="view" id="view-post-detail">
      <div class="post-detail-meta">
        <span id="detail-platform" class="post-platform linkedin">💼 LinkedIn</span>
        <span id="detail-date" class="post-date"></span>
      </div>
      <h1 class="doc-title" id="detail-title" style="margin-bottom: 20px;"></h1>
      <hr class="doc-divider" />
      <div class="post-detail-body" id="detail-body"></div>
      <div class="post-detail-actions">
        <button class="btn btn-ghost" onclick="showView('posts')">← Tillbaka</button>
        <button class="btn btn-ghost">Redigera</button>
        <button class="btn btn-ghost">+ Lägg till i CSV</button>
        <button class="btn btn-gold">Schemalägg</button>
      </div>
    </div>

    <!-- PUBLISHED VIEW -->
    <div class="view" id="view-published">
      <h1 class="doc-title" style="margin-bottom: 6px;">Publicerat</h1>
      <div class="doc-meta" style="margin-bottom: 28px;">Historik över publicerade inlägg</div>

      <div class="post-card">
        <div class="post-card-header">
          <span class="post-platform linkedin">💼 LinkedIn</span>
          <span class="post-date">Publicerat 14 feb 2026 · 847 visningar</span>
        </div>
        <div class="post-card-title">Varför oberoende rådgivning ger bättre resultat</div>
        <div class="post-card-preview">De flesta råd du får om din ekonomi kommer från någon som tjänar pengar på att du köper en viss produkt...</div>
      </div>

      <div class="post-card">
        <div class="post-card-header">
          <span class="post-platform instagram">📸 Instagram</span>
          <span class="post-date">Publicerat 11 feb 2026 · 1 204 visningar</span>
        </div>
        <div class="post-card-title">3 saker du borde göra med ditt bolags överskott</div>
        <div class="post-card-preview">Har du pengar som "väntar" i ditt bolag utan att göra nytta?...</div>
      </div>
    </div>

    <!-- EVENTS OVERVIEW -->
    <div class="view" id="view-events">
      <h1 class="doc-title" style="margin-bottom: 6px;">Kommande event</h1>
      <div class="doc-meta" style="margin-bottom: 28px;">2 event planerade</div>

      <div class="event-card" onclick="showEvent('varmingel')">
        <div class="event-card-header">
          <span class="event-badge planering">Planering</span>
          <span class="event-guests">👥 24 gäster</span>
        </div>
        <div class="event-card-title">Vårmingel 15 mars</div>
        <div class="event-meta">
          <span>📅 15 mars 2026</span>
          <span>📍 Brasserie Astoria, Stockholm</span>
        </div>
      </div>

      <div class="event-card" onclick="showEvent('kundevent')">
        <div class="event-card-header">
          <span class="event-badge bekraftat">Bekräftat</span>
          <span class="event-guests">👥 42 gäster</span>
        </div>
        <div class="event-card-title">Kundevent april</div>
        <div class="event-meta">
          <span>📅 10 april 2026</span>
          <span>📍 Fotografiska, Stockholm</span>
        </div>
      </div>
    </div>

    <!-- EVENT DETAIL -->
    <div class="view" id="view-event-detail">
      <span class="doc-icon">📅</span>
      <h1 class="doc-title" id="event-detail-title">Vårmingel 15 mars</h1>
      <div class="doc-meta" id="event-detail-meta" style="margin-bottom: 28px;">
        <span>📅 15 mars 2026, 17:00–20:00</span>
        <span class="dot">●</span>
        <span>📍 Brasserie Astoria, Stockholm</span>
      </div>
      <hr class="doc-divider" />

      <div class="doc-body" id="event-detail-body">
        <h2>Detaljer</h2>
        <div class="event-meta" style="flex-direction: column; align-items: flex-start; gap: 6px; margin-bottom: 20px;">
          <span><strong>Datum:</strong> 15 mars 2026</span>
          <span><strong>Tid:</strong> 17:00–20:00</span>
          <span><strong>Plats:</strong> Brasserie Astoria, Nybrogatan 6, Stockholm</span>
          <span><strong>Typ:</strong> Mingel &amp; networking</span>
        </div>

        <p>Informellt mingel för befintliga kunder och prospects. Syftet är att stärka relationer och presentera Cefunds tjänster i en avslappnad miljö.</p>

        <h2>Gästlista</h2>
        <table class="guest-table">
          <thead>
            <tr><th>Namn</th><th>E-post</th><th>Status</th></tr>
          </thead>
          <tbody>
            <tr><td>Anna Svensson</td><td>anna@foretaget.se</td><td><span class="guest-status bekraftad">Bekräftad</span></td></tr>
            <tr><td>Erik Johansson</td><td>erik@konsult.se</td><td><span class="guest-status bekraftad">Bekräftad</span></td></tr>
            <tr><td>Maria Lindberg</td><td>maria@startup.io</td><td><span class="guest-status bjuden">Bjuden</span></td></tr>
            <tr><td>Jonas Ek</td><td>jonas@byra.se</td><td><span class="guest-status bjuden">Bjuden</span></td></tr>
            <tr><td>Sara Holm</td><td>sara@invest.se</td><td><span class="guest-status tackat-nej">Tackat nej</span></td></tr>
          </tbody>
        </table>

        <h2>Att göra</h2>
        <div style="max-width: 480px;">
          <label class="checklist-item done"><input type="checkbox" checked /> Boka lokal</label>
          <label class="checklist-item done"><input type="checkbox" checked /> Skicka inbjudningar</label>
          <label class="checklist-item"><input type="checkbox" /> Beställ catering</label>
          <label class="checklist-item"><input type="checkbox" /> Förbereda presentation</label>
          <label class="checklist-item"><input type="checkbox" /> Skicka påminnelse 1 vecka innan</label>
        </div>
      </div>
    </div>

    <!-- GUESTLIST VIEW -->
    <div class="view" id="view-guestlist">
      <h1 class="doc-title" id="guestlist-title" style="margin-bottom: 6px;">Gästlista</h1>
      <div class="doc-meta" id="guestlist-event" style="margin-bottom: 20px;">Vårmingel 15 mars</div>

      <div class="event-summary" id="guestlist-summary">
        <div class="event-summary-badge"><strong>24</strong> Totalt</div>
        <div class="event-summary-badge"><strong>12</strong> Bekräftade</div>
        <div class="event-summary-badge"><strong>9</strong> Väntande</div>
        <div class="event-summary-badge"><strong>3</strong> Tackat nej</div>
      </div>

      <table class="guest-table" id="guestlist-table">
        <thead>
          <tr><th>Namn</th><th>E-post</th><th>Företag</th><th>Status</th></tr>
        </thead>
        <tbody>
          <tr><td>Anna Svensson</td><td>anna@foretaget.se</td><td>Företaget AB</td><td><span class="guest-status bekraftad">Bekräftad</span></td></tr>
          <tr><td>Erik Johansson</td><td>erik@konsult.se</td><td>Konsult &amp; Co</td><td><span class="guest-status bekraftad">Bekräftad</span></td></tr>
          <tr><td>Maria Lindberg</td><td>maria@startup.io</td><td>StartUp Nordic</td><td><span class="guest-status bjuden">Bjuden</span></td></tr>
          <tr><td>Jonas Ek</td><td>jonas@byra.se</td><td>Byrån AB</td><td><span class="guest-status bjuden">Bjuden</span></td></tr>
          <tr><td>Sara Holm</td><td>sara@invest.se</td><td>InvestCo</td><td><span class="guest-status tackat-nej">Tackat nej</span></td></tr>
          <tr><td>Karin Nilsson</td><td>karin@advokat.se</td><td>Advokatfirman</td><td><span class="guest-status bekraftad">Bekräftad</span></td></tr>
          <tr><td>Per Andersson</td><td>per@tech.se</td><td>TechSweden</td><td><span class="guest-status bjuden">Bjuden</span></td></tr>
        </tbody>
      </table>
    </div>

    <!-- EVENTS ARCHIVE -->
    <div class="view" id="view-events-archive">
      <h1 class="doc-title" style="margin-bottom: 6px;">Tidigare event</h1>
      <div class="doc-meta" style="margin-bottom: 28px;">Historik över genomförda event</div>

      <div class="event-card" style="opacity: 0.7; cursor: default;">
        <div class="event-card-header">
          <span class="event-badge" style="background: rgba(154,151,146,0.15); color: var(--muted);">Genomfört</span>
          <span class="event-guests">👥 38 gäster</span>
        </div>
        <div class="event-card-title">Julmingel 2025</div>
        <div class="event-meta">
          <span>📅 12 dec 2025</span>
          <span>📍 Grand Hôtel, Stockholm</span>
        </div>
      </div>
    </div>

    <!-- ═══ DASHBOARD ═══════════════════════════════════ -->
    <div class="view" id="view-dashboard">
      <span class="doc-icon">📊</span>
      <h1 class="doc-title" style="margin-bottom: 6px;">God morgon, Jenny</h1>
      <div class="doc-meta" style="margin-bottom: 28px;">Onsdag 19 februari 2026 · Här är din dagliga briefing</div>

      <div class="dashboard-cards">
        <div class="dash-card">
          <div class="dash-card-icon">📅</div>
          <div class="dash-card-value">2</div>
          <div class="dash-card-label">Möten idag</div>
        </div>
        <div class="dash-card">
          <div class="dash-card-icon">📧</div>
          <div class="dash-card-value">3</div>
          <div class="dash-card-label">Uppföljningar att skicka</div>
        </div>
        <div class="dash-card">
          <div class="dash-card-icon">📄</div>
          <div class="dash-card-value">1</div>
          <div class="dash-card-label">Offert väntar svar</div>
        </div>
        <div class="dash-card">
          <div class="dash-card-icon">🎉</div>
          <div class="dash-card-value">24</div>
          <div class="dash-card-label">Dagar till Vårmingel</div>
        </div>
      </div>

      <h2 class="section-title">Senaste aktivitet</h2>
      <div class="activity-feed">
        <div class="feed-item">
          <span class="feed-item-icon">🤖</span>
          <div class="feed-item-text"><strong>Relationshanteraren</strong> föreslog uppföljning: "14 dagar sedan du pratade med Maria Lindberg"</div>
          <span class="feed-item-time">08:30</span>
        </div>
        <div class="feed-item">
          <span class="feed-item-icon">✨</span>
          <div class="feed-item-text"><strong>Innehållsskaparen</strong> genererade nytt LinkedIn-inlägg från marknadskommentarer</div>
          <span class="feed-item-time">07:45</span>
        </div>
        <div class="feed-item">
          <span class="feed-item-icon">📅</span>
          <div class="feed-item-text"><strong>Mötesassistenten</strong> skapade pre-brief för möte med Erik Johansson kl 14:00</div>
          <span class="feed-item-time">07:00</span>
        </div>
        <div class="feed-item">
          <span class="feed-item-icon">📰</span>
          <div class="feed-item-text"><strong>Redaktören</strong> sammanställde utkast till nyhetsbrev #4 — redo för granskning</div>
          <span class="feed-item-time">Igår 22:00</span>
        </div>
        <div class="feed-item">
          <span class="feed-item-icon">💼</span>
          <div class="feed-item-text"><strong>Försäljningsassistenten</strong> påminnelse: Offert till Konsult &amp; Co skickad för 7 dagar sedan, inget svar</div>
          <span class="feed-item-time">Igår 18:00</span>
        </div>
      </div>

      <h2 class="section-title">Veckans innehåll</h2>
      <div class="mini-calendar">
        <div class="cal-day"><div class="cal-day-name">Mån</div><div class="cal-day-num">17</div><div class="cal-day-dot blue"></div></div>
        <div class="cal-day"><div class="cal-day-name">Tis</div><div class="cal-day-num">18</div><div class="cal-day-dot"></div></div>
        <div class="cal-day today"><div class="cal-day-name">Ons</div><div class="cal-day-num">19</div><div class="cal-day-dot gold"></div></div>
        <div class="cal-day"><div class="cal-day-name">Tor</div><div class="cal-day-num">20</div><div class="cal-day-dot"></div></div>
        <div class="cal-day"><div class="cal-day-name">Fre</div><div class="cal-day-num">21</div><div class="cal-day-dot blue"></div></div>
        <div class="cal-day"><div class="cal-day-name">Lör</div><div class="cal-day-num">22</div><div class="cal-day-dot"></div></div>
        <div class="cal-day"><div class="cal-day-name">Sön</div><div class="cal-day-num">23</div><div class="cal-day-dot"></div></div>
      </div>

      <h2 class="section-title" style="margin-top: 36px;">Automatiserade flöden</h2>
      <div class="flow-chain">
        <div class="flow-chain-title">🤝 Nätverka → Kund-kedjan</div>
        <div class="flow-steps">
          <span class="flow-step">Mingel</span><span class="flow-arrow">→</span>
          <span class="flow-step active-step">Kontakt skapas</span><span class="flow-arrow">→</span>
          <span class="flow-step">Möte bokas</span><span class="flow-arrow">→</span>
          <span class="flow-step">Pre-brief</span><span class="flow-arrow">→</span>
          <span class="flow-step">Möte</span><span class="flow-arrow">→</span>
          <span class="flow-step">Actions</span><span class="flow-arrow">→</span>
          <span class="flow-step">Offert</span><span class="flow-arrow">→</span>
          <span class="flow-step">Uppföljning</span><span class="flow-arrow">→</span>
          <span class="flow-step">Kund ✓</span>
        </div>
      </div>
      <div class="flow-chain">
        <div class="flow-chain-title">🎉 Event-kedjan</div>
        <div class="flow-steps">
          <span class="flow-step active-step">Event skapas</span><span class="flow-arrow">→</span>
          <span class="flow-step">Inbjudan + inlägg</span><span class="flow-arrow">→</span>
          <span class="flow-step">RSVP</span><span class="flow-arrow">→</span>
          <span class="flow-step">Tackmail</span><span class="flow-arrow">→</span>
          <span class="flow-step">Recap-inlägg</span><span class="flow-arrow">→</span>
          <span class="flow-step">Uppföljning</span>
        </div>
      </div>
      <div class="flow-chain">
        <div class="flow-chain-title">✍️ Content-kedjan</div>
        <div class="flow-steps">
          <span class="flow-step">Marknadskommentar</span><span class="flow-arrow">→</span>
          <span class="flow-step active-step">LinkedIn + IG</span><span class="flow-arrow">→</span>
          <span class="flow-step">Nyhetsbrev-sektion</span><span class="flow-arrow">→</span>
          <span class="flow-step">Publiceras</span>
        </div>
      </div>
    </div>

    <!-- ═══ KONTAKTER ═══════════════════════════════════ -->
    <div class="view" id="view-contacts">
      <span class="doc-icon">👥</span>
      <h1 class="doc-title" style="margin-bottom: 6px;">Alla kontakter</h1>
      <div class="doc-meta" style="margin-bottom: 28px;">12 kontakter · 3 kunder · 5 prospekt · 4 nätverk</div>
      <div class="contact-grid">
        <div class="contact-card">
          <div class="contact-card-header"><div class="contact-avatar">AS</div><div><div class="contact-name">Anna Svensson</div><div class="contact-company">Företaget AB</div></div></div>
          <span class="contact-tag kund">Kund</span>
          <div class="contact-last">Senaste kontakt: 12 feb 2026</div>
        </div>
        <div class="contact-card">
          <div class="contact-card-header"><div class="contact-avatar">EJ</div><div><div class="contact-name">Erik Johansson</div><div class="contact-company">Konsult &amp; Co</div></div></div>
          <span class="contact-tag prospekt">Prospekt</span>
          <div class="contact-last">Senaste kontakt: 5 feb 2026</div>
        </div>
        <div class="contact-card">
          <div class="contact-card-header"><div class="contact-avatar">ML</div><div><div class="contact-name">Maria Lindberg</div><div class="contact-company">StartUp Nordic</div></div></div>
          <span class="contact-tag prospekt">Prospekt</span>
          <div class="contact-last">Senaste kontakt: 4 feb 2026 · <span style="color:#e07070;">14 dagar sedan!</span></div>
        </div>
        <div class="contact-card">
          <div class="contact-card-header"><div class="contact-avatar">JE</div><div><div class="contact-name">Jonas Ek</div><div class="contact-company">Byrån AB</div></div></div>
          <span class="contact-tag natverk">Nätverk</span>
          <div class="contact-last">Senaste kontakt: 15 jan 2026</div>
        </div>
        <div class="contact-card">
          <div class="contact-card-header"><div class="contact-avatar">KN</div><div><div class="contact-name">Karin Nilsson</div><div class="contact-company">Advokatfirman</div></div></div>
          <span class="contact-tag kund">Kund</span>
          <div class="contact-last">Senaste kontakt: 18 feb 2026</div>
        </div>
        <div class="contact-card">
          <div class="contact-card-header"><div class="contact-avatar">PA</div><div><div class="contact-name">Per Andersson</div><div class="contact-company">TechSweden</div></div></div>
          <span class="contact-tag natverk">Nätverk</span>
          <div class="contact-last">Senaste kontakt: 20 jan 2026</div>
        </div>
      </div>
    </div>

    <!-- ═══ PIPELINE ════════════════════════════════════ -->
    <div class="view" id="view-pipeline">
      <span class="doc-icon">📊</span>
      <h1 class="doc-title" style="margin-bottom: 6px;">Pipeline</h1>
      <div class="doc-meta" style="margin-bottom: 28px;">Visuell vy över alla kontakter i säljprocessen</div>
      <div class="pipeline">
        <div class="pipeline-col">
          <div class="pipeline-col-header blue-border">Nätverk (4)</div>
          <div class="pipeline-item">Jonas Ek<div class="pipeline-item-sub">Byrån AB · Träffades på mingel</div></div>
          <div class="pipeline-item">Per Andersson<div class="pipeline-item-sub">TechSweden · LinkedIn-kontakt</div></div>
          <div class="pipeline-item">Lisa Bergström<div class="pipeline-item-sub">Fastighets AB · Referens från Karin</div></div>
          <div class="pipeline-item">Magnus Holm<div class="pipeline-item-sub">Invest Nordic · Branschevent</div></div>
        </div>
        <div class="pipeline-col">
          <div class="pipeline-col-header gold-border">Prospekt (5)</div>
          <div class="pipeline-item">Erik Johansson<div class="pipeline-item-sub">Konsult &amp; Co · Möte bokat 19 feb</div></div>
          <div class="pipeline-item">Maria Lindberg<div class="pipeline-item-sub">StartUp Nordic · Uppföljning behövs</div></div>
          <div class="pipeline-item">Sara Holm<div class="pipeline-item-sub">InvestCo · Intresserad av pension</div></div>
          <div class="pipeline-item">Henrik Dahl<div class="pipeline-item-sub">Dahl Konsulting · Första möte klart</div></div>
          <div class="pipeline-item">Eva Strand<div class="pipeline-item-sub">Strand &amp; Partners · Vill ha offert</div></div>
        </div>
        <div class="pipeline-col">
          <div class="pipeline-col-header" style="border-color:#d870a0;">Offert skickad (1)</div>
          <div class="pipeline-item">Erik Johansson<div class="pipeline-item-sub">Konsult &amp; Co · 45 000 kr/år · Skickad 12 feb</div></div>
        </div>
        <div class="pipeline-col">
          <div class="pipeline-col-header green-border">Kund (3)</div>
          <div class="pipeline-item">Anna Svensson<div class="pipeline-item-sub">Företaget AB · Kund sedan sep 2025</div></div>
          <div class="pipeline-item">Karin Nilsson<div class="pipeline-item-sub">Advokatfirman · Kund sedan nov 2025</div></div>
          <div class="pipeline-item">Thomas Berg<div class="pipeline-item-sub">Berg Holding · Kund sedan jan 2026</div></div>
        </div>
      </div>
    </div>

    <!-- ═══ MÖTEN ═══════════════════════════════════════ -->
    <div class="view" id="view-meetings">
      <span class="doc-icon">📅</span>
      <h1 class="doc-title" style="margin-bottom: 6px;">Kommande möten</h1>
      <div class="doc-meta" style="margin-bottom: 28px;">3 möten denna vecka</div>
      <div class="meeting-card">
        <div class="meeting-card-header"><span class="meeting-date-badge">📅 Idag 14:00</span><span class="meeting-type-badge">Uppföljning</span></div>
        <div class="meeting-card-title">Erik Johansson — Offertgenomgång</div>
        <div class="meeting-card-participants">👤 Erik Johansson (Konsult &amp; Co) · 📍 Digitalt (Teams)</div>
      </div>
      <div class="meeting-card">
        <div class="meeting-card-header"><span class="meeting-date-badge">📅 Idag 16:30</span><span class="meeting-type-badge">Första möte</span></div>
        <div class="meeting-card-title">Eva Strand — Intro &amp; behovsanalys</div>
        <div class="meeting-card-participants">👤 Eva Strand (Strand &amp; Partners) · 📍 Kontoret</div>
      </div>
      <div class="meeting-card">
        <div class="meeting-card-header"><span class="meeting-date-badge">📅 Fre 21 feb, 10:00</span><span class="meeting-type-badge">Kvartalsuppföljning</span></div>
        <div class="meeting-card-title">Anna Svensson — Portföljgenomgång Q1</div>
        <div class="meeting-card-participants">👤 Anna Svensson (Företaget AB) · 📍 Kontoret</div>
      </div>
      <div style="margin-top:20px;padding:16px 20px;background:rgba(201,169,110,0.05);border:1px solid rgba(201,169,110,0.2);border-radius:10px;max-width:640px;">
        <div style="font-size:12px;font-weight:600;color:var(--gold);margin-bottom:6px;">🤖 Mötesassistentens pre-brief</div>
        <div style="font-size:12.5px;color:var(--muted);line-height:1.6;"><strong style="color:var(--text);">Erik Johansson (14:00):</strong> Offert på 45 000 kr/år skickad 12 feb. Erik driver Konsult &amp; Co med 15 anställda. Främst intresserad av tjänstepension och kapitalförsäkring i bolaget.</div>
      </div>
    </div>

    <!-- ═══ MÖTESANTECKNINGAR ═══════════════════════════ -->
    <div class="view" id="view-meeting-notes">
      <span class="doc-icon">📝</span>
      <h1 class="doc-title" style="margin-bottom: 6px;">Mötesanteckningar</h1>
      <div class="doc-meta" style="margin-bottom: 28px;">Sökbara anteckningar från alla möten</div>
      <div class="meeting-card">
        <div class="meeting-card-header"><span class="meeting-date-badge">📅 5 feb 2026</span><span class="meeting-type-badge">Första möte</span></div>
        <div class="meeting-card-title">Erik Johansson — Behovsanalys</div>
        <div style="font-size:12.5px;color:var(--muted);line-height:1.6;margin-top:8px;">Erik driver Konsult &amp; Co, 15 anställda. Vill se över tjänstepension och placera bolagsöverskott...</div>
      </div>
      <div class="meeting-card">
        <div class="meeting-card-header"><span class="meeting-date-badge">📅 28 jan 2026</span><span class="meeting-type-badge">Kvartalsuppföljning</span></div>
        <div class="meeting-card-title">Anna Svensson — Q4 genomgång</div>
        <div style="font-size:12.5px;color:var(--muted);line-height:1.6;margin-top:8px;">Portföljen +8,2% YTD. Anna nöjd med allokeringen. Action: ta fram förslag på buffertlösning...</div>
      </div>
      <div class="meeting-card">
        <div class="meeting-card-header"><span class="meeting-date-badge">📅 15 jan 2026</span><span class="meeting-type-badge">Intro</span></div>
        <div class="meeting-card-title">Maria Lindberg — Nätverksmöte</div>
        <div style="font-size:12.5px;color:var(--muted);line-height:1.6;margin-top:8px;">Maria grundare av StartUp Nordic. Intresserad av personaloptioner och skatteplanering vid exit...</div>
      </div>
    </div>

    <!-- ═══ ERBJUDANDEN ═════════════════════════════════ -->
    <div class="view" id="view-offers">
      <span class="doc-icon">📄</span>
      <h1 class="doc-title" style="margin-bottom: 6px;">Aktiva offerter</h1>
      <div class="doc-meta" style="margin-bottom: 28px;">2 aktiva offerter · 1 väntar svar</div>
      <div class="offer-card">
        <div class="offer-card-header"><span class="offer-status skickad">Skickad</span><span class="offer-amount">45 000 kr/år</span></div>
        <div class="offer-card-title">Konsult &amp; Co — Helhetslösning pensionsplanering</div>
        <div class="offer-card-meta">👤 Erik Johansson · Skickad 12 feb 2026 · Väntar svar (7 dagar)</div>
      </div>
      <div class="offer-card">
        <div class="offer-card-header"><span class="offer-status utkast">Utkast</span><span class="offer-amount">32 000 kr/år</span></div>
        <div class="offer-card-title">Strand &amp; Partners — Kapitalförvaltning</div>
        <div class="offer-card-meta">👤 Eva Strand · Utkast skapad 18 feb 2026</div>
      </div>
      <div class="offer-card" style="opacity:0.6;">
        <div class="offer-card-header"><span class="offer-status accepterad">Accepterad</span><span class="offer-amount">38 000 kr/år</span></div>
        <div class="offer-card-title">Advokatfirman — Förmögenhetsplanering</div>
        <div class="offer-card-meta">👤 Karin Nilsson · Accepterad 2 nov 2025</div>
      </div>
      <div style="margin-top:20px;padding:16px 20px;background:rgba(201,169,110,0.05);border:1px solid rgba(201,169,110,0.2);border-radius:10px;max-width:640px;">
        <div style="font-size:12px;font-weight:600;color:var(--gold);margin-bottom:6px;">🤖 Försäljningsassistentens tips</div>
        <div style="font-size:12.5px;color:var(--muted);line-height:1.6;">Offerten till Erik Johansson har varit utan svar i 7 dagar. Förslag: skicka en mjuk uppföljning.</div>
      </div>
    </div>

    <!-- ═══ OFFERTMALLAR ════════════════════════════════ -->
    <div class="view" id="view-offer-templates">
      <span class="doc-icon">📋</span>
      <h1 class="doc-title" style="margin-bottom: 6px;">Offertmallar</h1>
      <div class="doc-meta" style="margin-bottom: 28px;">3 mallar tillgängliga</div>
      <div class="offer-card"><div class="offer-card-header"><span class="offer-status" style="background:rgba(201,169,110,0.15);color:var(--gold);">Mall</span></div><div class="offer-card-title">Helhetslösning — Privatperson</div><div class="offer-card-meta">Pensionsplanering · Kapitalallokering · Skatteoptimering</div></div>
      <div class="offer-card"><div class="offer-card-header"><span class="offer-status" style="background:rgba(201,169,110,0.15);color:var(--gold);">Mall</span></div><div class="offer-card-title">Företagspaket — Kapitalförvaltning</div><div class="offer-card-meta">Kapitalförsäkring · Tjänstepension · Bolagsstruktur</div></div>
      <div class="offer-card"><div class="offer-card-header"><span class="offer-status" style="background:rgba(201,169,110,0.15);color:var(--gold);">Mall</span></div><div class="offer-card-title">Generationsskifte</div><div class="offer-card-meta">Successionplanering · Skatteeffektiv överlåtelse · Familjerådgivning</div></div>
    </div>

    <!-- ═══ NYHETSBREV — UTKAST ═════════════════════════ -->
    <div class="view" id="view-newsletter-drafts">
      <span class="doc-icon">📰</span>
      <h1 class="doc-title" style="margin-bottom: 6px;">Nyhetsbrev</h1>
      <div class="doc-meta" style="margin-bottom: 28px;">3 utkast · 247 prenumeranter</div>
      <div class="newsletter-card">
        <div class="newsletter-card-header"><span class="newsletter-status utkast">Utkast</span><span style="font-size:11px;color:var(--muted);">Senast redigerad idag</span></div>
        <div class="newsletter-card-title">Cefund Nyhetsbrev #4 — Februari 2026</div>
        <div class="newsletter-card-meta">Marknadskommentar · Tips: pensionsöversyn · Event-promo: Vårmingel</div>
      </div>
      <div class="newsletter-card">
        <div class="newsletter-card-header"><span class="newsletter-status skickat">Skickat</span><span style="font-size:11px;color:var(--muted);">28 jan 2026 · 62% öppningsgrad</span></div>
        <div class="newsletter-card-title">Cefund Nyhetsbrev #3 — Januari 2026</div>
        <div class="newsletter-card-meta">Marknadsutsikter 2026 · Riksbankens räntebesked · Tips: 3:12-reglerna</div>
      </div>
      <div class="newsletter-card">
        <div class="newsletter-card-header"><span class="newsletter-status skickat">Skickat</span><span style="font-size:11px;color:var(--muted);">15 dec 2025 · 58% öppningsgrad</span></div>
        <div class="newsletter-card-title">Cefund Nyhetsbrev #2 — December 2025</div>
        <div class="newsletter-card-meta">Årssammanfattning · Skattetips inför nyår · Julmingel-recap</div>
      </div>
      <div style="margin-top:20px;padding:16px 20px;background:rgba(201,169,110,0.05);border:1px solid rgba(201,169,110,0.2);border-radius:10px;max-width:640px;">
        <div style="font-size:12px;font-weight:600;color:var(--gold);margin-bottom:6px;">🤖 Redaktörens förslag</div>
        <div style="font-size:12.5px;color:var(--muted);line-height:1.6;">Utkast #4 innehåller: marknadskommentar, topp-LinkedIn-inlägg denna månad, och event-promo för Vårmingel. Föreslår ämnesrad: "Riksbanken sänker — vad det betyder för dig"</div>
      </div>
    </div>

    <!-- ═══ PRENUMERANTER ═══════════════════════════════ -->
    <div class="view" id="view-newsletter-subscribers">
      <span class="doc-icon">👥</span>
      <h1 class="doc-title" style="margin-bottom: 6px;">Prenumeranter</h1>
      <div class="doc-meta" style="margin-bottom: 28px;">247 prenumeranter · 62% genomsnittlig öppningsgrad</div>
      <div class="event-summary" style="margin-bottom:24px;">
        <div class="event-summary-badge"><strong>247</strong> Totalt</div>
        <div class="event-summary-badge"><strong>198</strong> Aktiva</div>
        <div class="event-summary-badge"><strong>42</strong> Nya (30 dagar)</div>
        <div class="event-summary-badge"><strong>7</strong> Avregistrerade</div>
      </div>
      <table class="guest-table">
        <thead><tr><th>Namn</th><th>E-post</th><th>Sedan</th><th>Öppningsgrad</th></tr></thead>
        <tbody>
          <tr><td>Anna Svensson</td><td>anna@foretaget.se</td><td>Sep 2025</td><td>92%</td></tr>
          <tr><td>Erik Johansson</td><td>erik@konsult.se</td><td>Jan 2026</td><td>100%</td></tr>
          <tr><td>Maria Lindberg</td><td>maria@startup.io</td><td>Feb 2026</td><td>—</td></tr>
          <tr><td>Karin Nilsson</td><td>karin@advokat.se</td><td>Nov 2025</td><td>83%</td></tr>
          <tr><td>Per Andersson</td><td>per@tech.se</td><td>Dec 2025</td><td>67%</td></tr>
        </tbody>
      </table>
    </div>

    <!-- ═══ UPPGIFTER — IDAG ════════════════════════════ -->
    <div class="view" id="view-tasks-today">
      <span class="doc-icon">✅</span>
      <h1 class="doc-title" style="margin-bottom: 6px;">Idag</h1>
      <div class="doc-meta" style="margin-bottom: 28px;">5 uppgifter · 2 hög prioritet</div>
      <div class="task-item"><input type="checkbox" class="task-checkbox" /><div class="task-content"><div class="task-title">Förbered offertgenomgång med Erik Johansson<span class="task-tag mote">möte</span></div><div class="task-source">Från möte 5 feb · Deadline: idag 14:00</div></div><span class="task-priority hog">Hög</span></div>
      <div class="task-item"><input type="checkbox" class="task-checkbox" /><div class="task-content"><div class="task-title">Skicka uppföljning till Maria Lindberg<span class="task-tag mote">möte</span></div><div class="task-source">Relationshanteraren föreslog · 14 dagar utan kontakt</div></div><span class="task-priority hog">Hög</span></div>
      <div class="task-item"><input type="checkbox" class="task-checkbox" /><div class="task-content"><div class="task-title">Granska nyhetsbrevsutkast #4<span class="task-tag content">content</span></div><div class="task-source">Redaktören sammanställde utkast</div></div><span class="task-priority medel">Medel</span></div>
      <div class="task-item"><input type="checkbox" class="task-checkbox" /><div class="task-content"><div class="task-title">Publicera LinkedIn-inlägg om Riksbankens räntesänkning<span class="task-tag content">content</span></div><div class="task-source">Innehållsskaparen genererade — väntar på godkännande</div></div><span class="task-priority medel">Medel</span></div>
      <div class="task-item"><input type="checkbox" class="task-checkbox" /><div class="task-content"><div class="task-title">Beställ catering till Vårmingel<span class="task-tag event">event</span></div><div class="task-source">Eventplaneraren påminnelse · Deadline: 28 feb</div></div><span class="task-priority lag">Låg</span></div>
    </div>

    <!-- ═══ UPPGIFTER — DENNA VECKA ═════════════════════ -->
    <div class="view" id="view-tasks-week">
      <span class="doc-icon">📅</span>
      <h1 class="doc-title" style="margin-bottom: 6px;">Denna vecka</h1>
      <div class="doc-meta" style="margin-bottom: 28px;">Vecka 8 · 12 uppgifter kvar</div>
      <h2 class="section-title" style="margin-top:0;">Onsdag 19 feb</h2>
      <div class="task-item"><input type="checkbox" class="task-checkbox" /><div class="task-content"><div class="task-title">Offertgenomgång Erik Johansson<span class="task-tag mote">möte</span></div><div class="task-source">14:00 · Digitalt</div></div><span class="task-priority hog">Hög</span></div>
      <div class="task-item"><input type="checkbox" class="task-checkbox" /><div class="task-content"><div class="task-title">Intro Eva Strand<span class="task-tag mote">möte</span></div><div class="task-source">16:30 · Kontoret</div></div><span class="task-priority hog">Hög</span></div>
      <h2 class="section-title">Torsdag 20 feb</h2>
      <div class="task-item"><input type="checkbox" class="task-checkbox" /><div class="task-content"><div class="task-title">Färdigställ offert till Eva Strand<span class="task-tag offert">offert</span></div><div class="task-source">Baserat på intro-möte</div></div><span class="task-priority medel">Medel</span></div>
      <div class="task-item"><input type="checkbox" class="task-checkbox" /><div class="task-content"><div class="task-title">Skicka påminnelse om Vårmingel<span class="task-tag event">event</span></div><div class="task-source">Eventplaneraren · Till alla som inte RSVP:at</div></div><span class="task-priority lag">Låg</span></div>
      <h2 class="section-title">Fredag 21 feb</h2>
      <div class="task-item"><input type="checkbox" class="task-checkbox" /><div class="task-content"><div class="task-title">Portföljgenomgång Anna Svensson<span class="task-tag mote">möte</span></div><div class="task-source">10:00 · Kontoret</div></div><span class="task-priority medel">Medel</span></div>
      <div class="task-item"><input type="checkbox" class="task-checkbox" /><div class="task-content"><div class="task-title">Veckorapport — sammanfatta veckans resultat<span class="task-tag content">content</span></div><div class="task-source">Projektledaren · Automatisk påminnelse</div></div><span class="task-priority lag">Låg</span></div>
    </div>

    <!-- ═══ AI-TEAM — AGENTER ═══════════════════════════ -->
    <div class="view" id="view-ai-agents">
      <span class="doc-icon">🤖</span>
      <h1 class="doc-title" style="margin-bottom: 6px;">AI-Team</h1>
      <div class="doc-meta" style="margin-bottom: 28px;">8 agenter · 7 aktiva · 47 åtgärder denna vecka</div>
      <div class="agent-grid">
        <div class="agent-card">
          <div class="agent-card-header"><span class="agent-icon">👑</span><div><div class="agent-name">Chefsassistenten</div><div class="agent-role">Daglig briefing &amp; prioritering</div></div></div>
          <span class="agent-status aktiv"><span class="agent-status-dot"></span> Aktiv</span>
          <div class="agent-stats"><strong>12</strong> åtgärder denna vecka · Ansvarar för <strong>Dashboard</strong></div>
          <div class="agent-log"><div class="agent-log-item"><span class="agent-log-time">08:30</span> Genererade daglig briefing</div><div class="agent-log-item"><span class="agent-log-time">08:00</span> Prioriterade 5 uppgifter för idag</div></div>
        </div>
        <div class="agent-card">
          <div class="agent-card-header"><span class="agent-icon">🤝</span><div><div class="agent-name">Relationshanteraren</div><div class="agent-role">Kontakter &amp; uppföljningar</div></div></div>
          <span class="agent-status aktiv"><span class="agent-status-dot"></span> Aktiv</span>
          <div class="agent-stats"><strong>8</strong> åtgärder denna vecka · Ansvarar för <strong>Kontakter</strong></div>
          <div class="agent-log"><div class="agent-log-item"><span class="agent-log-time">08:30</span> Föreslog uppföljning: Maria Lindberg</div><div class="agent-log-item"><span class="agent-log-time">Igår</span> Uppdaterade status: Erik → Prospekt</div></div>
        </div>
        <div class="agent-card">
          <div class="agent-card-header"><span class="agent-icon">📅</span><div><div class="agent-name">Mötesassistenten</div><div class="agent-role">Pre-briefs &amp; mötesbearbetning</div></div></div>
          <span class="agent-status aktiv"><span class="agent-status-dot"></span> Aktiv</span>
          <div class="agent-stats"><strong>6</strong> åtgärder denna vecka · Ansvarar för <strong>Möten</strong></div>
          <div class="agent-log"><div class="agent-log-item"><span class="agent-log-time">07:00</span> Skapade pre-brief: Erik Johansson</div><div class="agent-log-item"><span class="agent-log-time">Igår</span> Extraherade actions från möte med Henrik</div></div>
        </div>
        <div class="agent-card">
          <div class="agent-card-header"><span class="agent-icon">💼</span><div><div class="agent-name">Försäljningsassistenten</div><div class="agent-role">Offerter &amp; pipeline</div></div></div>
          <span class="agent-status aktiv"><span class="agent-status-dot"></span> Aktiv</span>
          <div class="agent-stats"><strong>5</strong> åtgärder denna vecka · Ansvarar för <strong>Erbjudanden</strong></div>
          <div class="agent-log"><div class="agent-log-item"><span class="agent-log-time">Igår</span> Påminnelse: Erik-offert utan svar (7 dagar)</div><div class="agent-log-item"><span class="agent-log-time">Mån</span> Skrev utkast: Offert Eva Strand</div></div>
        </div>
        <div class="agent-card">
          <div class="agent-card-header"><span class="agent-icon">✨</span><div><div class="agent-name">Innehållsskaparen</div><div class="agent-role">Inlägg &amp; batchgenerering</div></div></div>
          <span class="agent-status aktiv"><span class="agent-status-dot"></span> Aktiv</span>
          <div class="agent-stats"><strong>9</strong> åtgärder denna vecka · Ansvarar för <strong>Content</strong></div>
          <div class="agent-log"><div class="agent-log-item"><span class="agent-log-time">07:45</span> Genererade LinkedIn-inlägg från marknadsdata</div><div class="agent-log-item"><span class="agent-log-time">Igår</span> Batch: 7 inlägg redo för granskning</div></div>
        </div>
        <div class="agent-card">
          <div class="agent-card-header"><span class="agent-icon">📰</span><div><div class="agent-name">Redaktören</div><div class="agent-role">Nyhetsbrev &amp; innehållskompilering</div></div></div>
          <span class="agent-status aktiv"><span class="agent-status-dot"></span> Aktiv</span>
          <div class="agent-stats"><strong>4</strong> åtgärder denna vecka · Ansvarar för <strong>Nyhetsbrev</strong></div>
          <div class="agent-log"><div class="agent-log-item"><span class="agent-log-time">Igår</span> Sammanställde utkast: Nyhetsbrev #4</div><div class="agent-log-item"><span class="agent-log-time">Mån</span> Föreslog ämnesrad baserat på bästa inlägg</div></div>
        </div>
        <div class="agent-card">
          <div class="agent-card-header"><span class="agent-icon">🎉</span><div><div class="agent-name">Eventplaneraren</div><div class="agent-role">Eventlogistik &amp; inbjudningar</div></div></div>
          <span class="agent-status aktiv"><span class="agent-status-dot"></span> Aktiv</span>
          <div class="agent-stats"><strong>3</strong> åtgärder denna vecka · Ansvarar för <strong>Event</strong></div>
          <div class="agent-log"><div class="agent-log-item"><span class="agent-log-time">Igår</span> Påminnelse: beställ catering (deadline 28 feb)</div><div class="agent-log-item"><span class="agent-log-time">Mån</span> Skickade påminnelse till 9 ej RSVP:ade</div></div>
        </div>
        <div class="agent-card">
          <div class="agent-card-header"><span class="agent-icon">✅</span><div><div class="agent-name">Projektledaren</div><div class="agent-role">Tasks, påminnelser, deadlines</div></div></div>
          <span class="agent-status pausad"><span class="agent-status-dot"></span> Pausad</span>
          <div class="agent-stats"><strong>0</strong> åtgärder denna vecka · Ansvarar för <strong>Uppgifter</strong></div>
          <div class="agent-log"><div class="agent-log-item"><span class="agent-log-time">—</span> Väntar på aktivering</div></div>
        </div>
      </div>
    </div>

    <!-- ═══ AI-AKTIVITETSLOGG ═══════════════════════════ -->
    <div class="view" id="view-ai-log">
      <span class="doc-icon">📋</span>
      <h1 class="doc-title" style="margin-bottom: 6px;">Aktivitetslogg</h1>
      <div class="doc-meta" style="margin-bottom: 28px;">Alla AI-åtgärder de senaste 7 dagarna</div>
      <div class="activity-feed" style="max-width:700px;">
        <div class="feed-item"><span class="feed-item-icon">👑</span><div class="feed-item-text"><strong>Chefsassistenten</strong> genererade daglig briefing med 5 prioriterade uppgifter</div><span class="feed-item-time">Idag 08:30</span></div>
        <div class="feed-item"><span class="feed-item-icon">🤝</span><div class="feed-item-text"><strong>Relationshanteraren</strong> föreslog uppföljning: "14 dagar sedan Maria Lindberg"</div><span class="feed-item-time">Idag 08:30</span></div>
        <div class="feed-item"><span class="feed-item-icon">✨</span><div class="feed-item-text"><strong>Innehållsskaparen</strong> genererade LinkedIn-inlägg från marknadskommentarer</div><span class="feed-item-time">Idag 07:45</span></div>
        <div class="feed-item"><span class="feed-item-icon">📅</span><div class="feed-item-text"><strong>Mötesassistenten</strong> skapade pre-brief för möte med Erik Johansson</div><span class="feed-item-time">Idag 07:00</span></div>
        <div class="feed-item"><span class="feed-item-icon">📰</span><div class="feed-item-text"><strong>Redaktören</strong> sammanställde utkast till Nyhetsbrev #4</div><span class="feed-item-time">Igår 22:00</span></div>
        <div class="feed-item"><span class="feed-item-icon">💼</span><div class="feed-item-text"><strong>Försäljningsassistenten</strong> flaggade: Erik-offert utan svar (7 dagar)</div><span class="feed-item-time">Igår 18:00</span></div>
        <div class="feed-item"><span class="feed-item-icon">🎉</span><div class="feed-item-text"><strong>Eventplaneraren</strong> skickade RSVP-påminnelse till 9 gäster (Vårmingel)</div><span class="feed-item-time">Mån 10:00</span></div>
        <div class="feed-item"><span class="feed-item-icon">💼</span><div class="feed-item-text"><strong>Försäljningsassistenten</strong> skrev offertutkast: Eva Strand</div><span class="feed-item-time">Mån 09:00</span></div>
        <div class="feed-item"><span class="feed-item-icon">📰</span><div class="feed-item-text"><strong>Redaktören</strong> föreslog ämnesrad: "Riksbanken sänker — vad det betyder för dig"</div><span class="feed-item-time">Mån 08:00</span></div>
        <div class="feed-item"><span class="feed-item-icon">✨</span><div class="feed-item-text"><strong>Innehållsskaparen</strong> batch-genererade 7 inlägg (LinkedIn tankeledare)</div><span class="feed-item-time">Sön 20:00</span></div>
      </div>
    </div>

  </div>

    <!-- ÖVERSIKT -->
    <div class="view" id="view-oversikt">
      <h1 class="doc-title" style="margin-bottom: 6px;">Översikt</h1>
      <div class="doc-meta" style="margin-bottom: 24px;">Vecka 8 · 16–22 feb 2026</div>

      <div class="dash-stats">
        <div class="dash-stat">
          <div class="dash-stat-value">7</div>
          <div class="dash-stat-label">Utkast</div>
          <div class="dash-stat-change">+3 den här veckan</div>
        </div>
        <div class="dash-stat">
          <div class="dash-stat-value">3</div>
          <div class="dash-stat-label">Schemalagda</div>
          <div class="dash-stat-change">Nästa: 19 feb</div>
        </div>
        <div class="dash-stat">
          <div class="dash-stat-value">12</div>
          <div class="dash-stat-label">Publicerade totalt</div>
          <div class="dash-stat-change">+2 senaste 7 dagarna</div>
        </div>
        <div class="dash-stat">
          <div class="dash-stat-value">5</div>
          <div class="dash-stat-label">Källor</div>
          <div class="dash-stat-change neutral">Transkript, docs, webb</div>
        </div>
      </div>

      <div class="dash-grid">
        <div>
          <div class="dash-card">
            <div class="dash-card-title">Senaste aktivitet</div>
            <div class="activity-item">
              <div class="activity-dot gold"></div>
              <div class="activity-text">7 LinkedIn Tankeledare genererade</div>
              <div class="activity-time">Idag 14:32</div>
            </div>
            <div class="activity-item">
              <div class="activity-dot green"></div>
              <div class="activity-text">Inlägg publicerat · <em>Varför oberoende rådgivning...</em></div>
              <div class="activity-time">14 feb</div>
            </div>
            <div class="activity-item">
              <div class="activity-dot blue"></div>
              <div class="activity-text">Nytt källmaterial tillagt · Investerardag feb 2026</div>
              <div class="activity-time">12 feb</div>
            </div>
            <div class="activity-item">
              <div class="activity-dot green"></div>
              <div class="activity-text">Inlägg publicerat · <em>3 saker du borde göra med...</em></div>
              <div class="activity-time">11 feb</div>
            </div>
            <div class="activity-item">
              <div class="activity-dot gold"></div>
              <div class="activity-text">5 Instagram Quotes genererade</div>
              <div class="activity-time">10 feb</div>
            </div>
          </div>

          <div class="dash-card">
            <div class="dash-card-title">Kommande schemalagda inlägg</div>
            <div class="activity-item">
              <div class="activity-dot blue"></div>
              <div class="activity-text"><span class="post-platform linkedin" style="font-size:10px; padding:2px 6px;">💼 LinkedIn</span>&nbsp; Oberoende rådgivning som affärsmodell</div>
              <div class="activity-time">16 feb</div>
            </div>
            <div class="activity-item">
              <div class="activity-dot" style="background:#d870a0;"></div>
              <div class="activity-text"><span class="post-platform instagram" style="font-size:10px; padding:2px 6px;">📸 Instagram</span>&nbsp; Pengarna i ditt bolag borde jobba</div>
              <div class="activity-time">19 feb</div>
            </div>
            <div class="activity-item">
              <div class="activity-dot blue"></div>
              <div class="activity-text"><span class="post-platform linkedin" style="font-size:10px; padding:2px 6px;">💼 LinkedIn</span>&nbsp; Tid i marknaden slår timing</div>
              <div class="activity-time">23 feb</div>
            </div>
          </div>
        </div>

        <div>
          <div class="dash-card">
            <div class="dash-card-title">Snabbåtgärder</div>
            <div class="quick-action" onclick="showBatch()">
              <div class="quick-action-icon">⚡</div>
              <div>
                <div class="quick-action-label">Generera flera inlägg</div>
                <div class="quick-action-sub">7 inlägg på en gång</div>
              </div>
            </div>
            <div class="quick-action" onclick="togglePanel(); showView('doc')">
              <div class="quick-action-icon">✨</div>
              <div>
                <div class="quick-action-label">Generera ett inlägg</div>
                <div class="quick-action-sub">Välj källa och tonläge</div>
              </div>
            </div>
            <div class="quick-action" onclick="openModal('transkript')">
              <div class="quick-action-icon">🎙️</div>
              <div>
                <div class="quick-action-label">Lägg till transkript</div>
                <div class="quick-action-sub">Klistra in text</div>
              </div>
            </div>
            <div class="quick-action" onclick="showPipeline()">
              <div class="quick-action-icon">🗂️</div>
              <div>
                <div class="quick-action-label">Öppna pipeline</div>
                <div class="quick-action-sub">Se status på alla inlägg</div>
              </div>
            </div>
            <div class="quick-action" onclick="showKalender()">
              <div class="quick-action-icon">🗓️</div>
              <div>
                <div class="quick-action-label">Öppna kalender</div>
                <div class="quick-action-sub">Schemalagda inlägg</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- PIPELINE -->
    <div class="view" id="view-pipeline">
      <h1 class="doc-title" style="margin-bottom: 6px;">Pipeline</h1>
      <div class="doc-meta" style="margin-bottom: 0;">11 inlägg totalt · 3 schemalagda denna vecka</div>

      <div class="pipeline-board">
        <!-- Utkast -->
        <div class="pipeline-col">
          <div class="pipeline-col-header">
            <div class="pipeline-col-title">
              <div class="pipeline-col-dot" style="background:#555;"></div>
              Utkast
            </div>
            <div class="pipeline-col-count">4</div>
          </div>
          <div class="pipeline-cards">
            <div class="pipe-card">
              <div class="pipe-card-title">Varför timing av marknaden aldrig funkar</div>
              <div class="pipe-card-meta">
                <span class="post-platform linkedin" style="font-size:10px; padding:2px 6px;">💼 LinkedIn</span>
                <span class="pipe-card-date">Skapad idag</span>
                <button class="pipe-move-btn" onclick="movePipeCard(this, 'klar')">→ Klar</button>
              </div>
            </div>
            <div class="pipe-card">
              <div class="pipe-card-title">5 saker du behöver veta om tjänstepensionen</div>
              <div class="pipe-card-meta">
                <span class="post-platform linkedin" style="font-size:10px; padding:2px 6px;">💼 LinkedIn</span>
                <span class="pipe-card-date">Skapad idag</span>
                <button class="pipe-move-btn" onclick="movePipeCard(this, 'klar')">→ Klar</button>
              </div>
            </div>
            <div class="pipe-card">
              <div class="pipe-card-title">Citat: "Oberoende rådgivning är inte ett löfte..."</div>
              <div class="pipe-card-meta">
                <span class="post-platform instagram" style="font-size:10px; padding:2px 6px;">📸 Instagram</span>
                <span class="pipe-card-date">Skapad idag</span>
                <button class="pipe-move-btn" onclick="movePipeCard(this, 'klar')">→ Klar</button>
              </div>
            </div>
            <div class="pipe-card">
              <div class="pipe-card-title">3 vanliga misstag med bolagspengar</div>
              <div class="pipe-card-meta">
                <span class="post-platform instagram" style="font-size:10px; padding:2px 6px;">📸 Instagram</span>
                <span class="pipe-card-date">Skapad 18 feb</span>
                <button class="pipe-move-btn" onclick="movePipeCard(this, 'klar')">→ Klar</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Klar -->
        <div class="pipeline-col">
          <div class="pipeline-col-header">
            <div class="pipeline-col-title">
              <div class="pipeline-col-dot" style="background:var(--gold);"></div>
              Klar
            </div>
            <div class="pipeline-col-count" id="pipe-count-klar">2</div>
          </div>
          <div class="pipeline-cards" id="pipe-cards-klar">
            <div class="pipe-card">
              <div class="pipe-card-title">Riksbankens signaler — vad innebär det för dig?</div>
              <div class="pipe-card-meta">
                <span class="post-platform linkedin" style="font-size:10px; padding:2px 6px;">💼 LinkedIn</span>
                <span class="pipe-card-date">Redigerad 17 feb</span>
                <button class="pipe-move-btn" onclick="movePipeCard(this, 'schemalagd')">→ Schemalägg</button>
              </div>
            </div>
            <div class="pipe-card">
              <div class="pipe-card-title">Pensionssparande: karusell om fondval</div>
              <div class="pipe-card-meta">
                <span class="post-platform instagram" style="font-size:10px; padding:2px 6px;">📸 Instagram</span>
                <span class="pipe-card-date">Redigerad 16 feb</span>
                <button class="pipe-move-btn" onclick="movePipeCard(this, 'schemalagd')">→ Schemalägg</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Schemalagd -->
        <div class="pipeline-col">
          <div class="pipeline-col-header">
            <div class="pipeline-col-title">
              <div class="pipeline-col-dot" style="background:var(--linkedin);"></div>
              Schemalagd
            </div>
            <div class="pipeline-col-count" id="pipe-count-schemalagd">3</div>
          </div>
          <div class="pipeline-cards" id="pipe-cards-schemalagd">
            <div class="pipe-card">
              <div class="pipe-card-title">Oberoende rådgivning som affärsmodell</div>
              <div class="pipe-card-meta">
                <span class="post-platform linkedin" style="font-size:10px; padding:2px 6px;">💼 LinkedIn</span>
                <span class="pipe-card-date">📅 16 feb 09:00</span>
                <button class="pipe-move-btn" onclick="movePipeCard(this, 'publicerat')">→ Publicerat</button>
              </div>
            </div>
            <div class="pipe-card">
              <div class="pipe-card-title">Pengarna i ditt bolag borde jobba</div>
              <div class="pipe-card-meta">
                <span class="post-platform instagram" style="font-size:10px; padding:2px 6px;">📸 Instagram</span>
                <span class="pipe-card-date">📅 19 feb 12:00</span>
                <button class="pipe-move-btn" onclick="movePipeCard(this, 'publicerat')">→ Publicerat</button>
              </div>
            </div>
            <div class="pipe-card">
              <div class="pipe-card-title">Tid i marknaden slår alltid timing</div>
              <div class="pipe-card-meta">
                <span class="post-platform linkedin" style="font-size:10px; padding:2px 6px;">💼 LinkedIn</span>
                <span class="pipe-card-date">📅 23 feb 09:00</span>
                <button class="pipe-move-btn" onclick="movePipeCard(this, 'publicerat')">→ Publicerat</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Publicerat -->
        <div class="pipeline-col">
          <div class="pipeline-col-header">
            <div class="pipeline-col-title">
              <div class="pipeline-col-dot" style="background:#6dbf7e;"></div>
              Publicerat
            </div>
            <div class="pipeline-col-count" id="pipe-count-publicerat">2</div>
          </div>
          <div class="pipeline-cards" id="pipe-cards-publicerat">
            <div class="pipe-card">
              <div class="pipe-card-title">Varför oberoende rådgivning ger bättre resultat</div>
              <div class="pipe-card-meta">
                <span class="post-platform linkedin" style="font-size:10px; padding:2px 6px;">💼 LinkedIn</span>
                <span class="pipe-card-date">Publicerat 14 feb · 847 visn.</span>
              </div>
            </div>
            <div class="pipe-card">
              <div class="pipe-card-title">3 saker du borde göra med ditt bolags överskott</div>
              <div class="pipe-card-meta">
                <span class="post-platform instagram" style="font-size:10px; padding:2px 6px;">📸 Instagram</span>
                <span class="pipe-card-date">Publicerat 11 feb · 1 204 visn.</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- KALENDER -->
    <div class="view" id="view-kalender">
      <div class="cal-header-row">
        <div class="cal-nav">
          <div class="cal-nav-btn">‹</div>
          <div class="cal-month">Februari 2026</div>
          <div class="cal-nav-btn">›</div>
        </div>
        <div class="cal-legend">
          <div class="cal-legend-item">
            <div class="cal-legend-dot" style="background:var(--linkedin);"></div>
            LinkedIn
          </div>
          <div class="cal-legend-item">
            <div class="cal-legend-dot" style="background:#d870a0;"></div>
            Instagram
          </div>
          <div class="cal-legend-item">
            <div class="cal-legend-dot" style="background:var(--gold);"></div>
            Event
          </div>
        </div>
      </div>

      <div class="cal-weekdays">
        <div class="cal-weekday">Mån</div>
        <div class="cal-weekday">Tis</div>
        <div class="cal-weekday">Ons</div>
        <div class="cal-weekday">Tor</div>
        <div class="cal-weekday">Fre</div>
        <div class="cal-weekday">Lör</div>
        <div class="cal-weekday">Sön</div>
      </div>

      <div class="cal-grid">
        <!-- Rad 1: 26 jan – 1 feb -->
        <div class="cal-day other-month"><div class="cal-day-num">26</div></div>
        <div class="cal-day other-month"><div class="cal-day-num">27</div></div>
        <div class="cal-day other-month"><div class="cal-day-num">28</div></div>
        <div class="cal-day other-month"><div class="cal-day-num">29</div></div>
        <div class="cal-day other-month"><div class="cal-day-num">30</div></div>
        <div class="cal-day other-month"><div class="cal-day-num">31</div></div>
        <div class="cal-day"><div class="cal-day-num">1</div></div>
        <!-- Rad 2: 2–8 feb -->
        <div class="cal-day"><div class="cal-day-num">2</div></div>
        <div class="cal-day"><div class="cal-day-num">3</div></div>
        <div class="cal-day"><div class="cal-day-num">4</div></div>
        <div class="cal-day"><div class="cal-day-num">5</div></div>
        <div class="cal-day"><div class="cal-day-num">6</div></div>
        <div class="cal-day"><div class="cal-day-num">7</div></div>
        <div class="cal-day"><div class="cal-day-num">8</div></div>
        <!-- Rad 3: 9–15 feb -->
        <div class="cal-day"><div class="cal-day-num">9</div></div>
        <div class="cal-day"><div class="cal-day-num">10</div></div>
        <div class="cal-day"><div class="cal-day-num">11</div>
          <div class="cal-event instagram">3 saker med bolagsöverskottet</div>
        </div>
        <div class="cal-day"><div class="cal-day-num">12</div></div>
        <div class="cal-day"><div class="cal-day-num">13</div></div>
        <div class="cal-day"><div class="cal-day-num">14</div>
          <div class="cal-event linkedin">Varför oberoende rådgivning...</div>
        </div>
        <div class="cal-day"><div class="cal-day-num">15</div></div>
        <!-- Rad 4: 16–22 feb -->
        <div class="cal-day"><div class="cal-day-num">16</div>
          <div class="cal-event linkedin">Oberoende som affärsmodell</div>
        </div>
        <div class="cal-day"><div class="cal-day-num">17</div></div>
        <div class="cal-day"><div class="cal-day-num">18</div></div>
        <div class="cal-day today"><div class="cal-day-num">19</div>
          <div class="cal-event instagram">Pengarna i ditt bolag</div>
        </div>
        <div class="cal-day"><div class="cal-day-num">20</div></div>
        <div class="cal-day"><div class="cal-day-num">21</div></div>
        <div class="cal-day"><div class="cal-day-num">22</div></div>
        <!-- Rad 5: 23–28 feb + 1 mar -->
        <div class="cal-day last-row"><div class="cal-day-num">23</div>
          <div class="cal-event linkedin">Tid i marknaden slår timing</div>
        </div>
        <div class="cal-day last-row"><div class="cal-day-num">24</div></div>
        <div class="cal-day last-row"><div class="cal-day-num">25</div>
          <div class="cal-event instagram">Pensionskarusell</div>
        </div>
        <div class="cal-day last-row"><div class="cal-day-num">26</div></div>
        <div class="cal-day last-row"><div class="cal-day-num">27</div></div>
        <div class="cal-day last-row"><div class="cal-day-num">28</div></div>
        <div class="cal-day last-row other-month"><div class="cal-day-num">1</div></div>
      </div>
    </div>

  </div>

  <!-- Batch export bar (fast under scroll-arean) -->
  <div class="batch-export-bar" id="batch-export-bar">
    <div class="batch-selected-text">
      <strong id="batch-count">0</strong> inlägg valda för export
    </div>
    <div class="batch-export-actions">
      <button class="btn btn-ghost" onclick="clearBatchSelection()">Rensa val</button>
      <button class="csv-download-btn ready" onclick="exportBatchCSV()">↓ Exportera till CSV</button>
    </div>
  </div>
</main>

<!-- ═══ GENERATE PANEL ══════════════════════════════ -->
<aside class="generate-panel hidden" id="generate-panel">
  <div class="panel-header">
    <div class="panel-title">✨ Generera inlägg</div>
    <div class="panel-close" onclick="togglePanel()">✕</div>
  </div>

  <div class="panel-body">

    <!-- Platform -->
    <div>
      <div class="panel-section-label">Plattform</div>
      <div class="platform-tabs">
        <button class="platform-tab active linkedin" onclick="setPlatform('linkedin', this)">💼 LinkedIn</button>
        <button class="platform-tab instagram" onclick="setPlatform('instagram', this)">📸 Instagram</button>
      </div>
    </div>

    <!-- Sources -->
    <div>
      <div class="panel-section-label">Källor</div>
      <div class="source-list">
        <label class="source-item checked">
          <input type="checkbox" checked /> Investeringsfilosofi
        </label>
        <label class="source-item checked">
          <input type="checkbox" checked /> Kundberättelser
        </label>
        <label class="source-item">
          <input type="checkbox" /> Marknadskommentarer
        </label>
        <label class="source-item">
          <input type="checkbox" /> Hemsida (cefund.se)
        </label>
        <label class="source-item">
          <input type="checkbox" /> Teamets bakgrund
        </label>
      </div>
    </div>

    <!-- Tone -->
    <div>
      <div class="panel-section-label">Tonläge</div>
      <select class="tone-select">
        <option>Pedagogisk</option>
        <option>Personlig &amp; varm</option>
        <option>Professionell</option>
        <option>Provocerande</option>
        <option>Berättande</option>
        <option>Data-driven</option>
      </select>
    </div>

    <!-- Generate button -->
    <button class="generate-btn" onclick="generate()">
      ✨ Generera inlägg
    </button>

    <div class="panel-divider"></div>

    <!-- Preview -->
    <div style="display:flex; flex-direction:column; gap:10px; flex:1;">
      <div class="panel-section-label">Förhandsvisning</div>
      <div class="preview-box" id="preview-box">
        Välj källor och tonläge, sedan klickar du Generera inlägg...
      </div>
      <div class="preview-generating" id="preview-spinner">
        <div class="spinner"></div>
        <span>Genererar inlägg...</span>
      </div>
      <div class="preview-actions" id="preview-actions">
        <button class="btn-copy" onclick="copyPreview()">Kopiera</button>
        <button class="btn-copy" id="btn-add-csv" onclick="addToCSV()">+ Lägg till i CSV</button>
      </div>
    </div>

  </div>

  <!-- CSV footer -->
  <div class="csv-footer">
    <div class="csv-queue">
      <strong id="csv-count">0</strong> inlägg i kö
    </div>
    <button class="csv-download-btn" id="csv-download-btn" onclick="downloadCSV()" disabled>
      ↓ Ladda ner CSV
    </button>
  </div>
</aside>

<!-- ═══ ADD SOURCE MODAL ═════════════════════════════ -->
<div class="modal-overlay" id="modal-overlay" onclick="handleOverlayClick(event)">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title">Lägg till källa</div>
      <div class="modal-close" onclick="closeModal()">✕</div>
    </div>

    <div class="modal-type-tabs">
      <button class="modal-tab" data-type="transkript" onclick="setModalType('transkript', this)">🎙️ Transkript</button>
      <button class="modal-tab" data-type="presentation" onclick="setModalType('presentation', this)">📊 Presentation</button>
      <button class="modal-tab" data-type="dokument" onclick="setModalType('dokument', this)">📄 Dokument</button>
      <button class="modal-tab" data-type="webblank" onclick="setModalType('webblank', this)">🌐 Webblänk</button>
    </div>

    <!-- Transkript form -->
    <div class="modal-form" id="form-transkript">
      <div class="form-group">
        <label>Titel</label>
        <input type="text" placeholder="t.ex. Investerardag mars 2026" />
      </div>
      <div class="form-group">
        <label>Klistra in transkript</label>
        <textarea rows="9" placeholder="Klistra in text från inspelning eller AI-transkribering..."></textarea>
      </div>
    </div>

    <!-- Presentation form -->
    <div class="modal-form" id="form-presentation">
      <div class="upload-area">
        <div class="upload-icon">📊</div>
        <div>Dra och släpp PDF eller PPTX</div>
        <div class="upload-sub">eller klicka för att välja fil</div>
      </div>
      <div class="form-group" style="margin-top: 16px;">
        <label>Titel</label>
        <input type="text" placeholder="t.ex. Q1 Kundpresentation" />
      </div>
    </div>

    <!-- Dokument form -->
    <div class="modal-form" id="form-dokument">
      <div class="form-group">
        <label>Titel</label>
        <input type="text" placeholder="t.ex. Marknadskommentarer mars 2026" />
      </div>
      <div class="form-group">
        <label>Innehåll</label>
        <textarea rows="9" placeholder="Klistra in text..."></textarea>
      </div>
    </div>

    <!-- Webblänk form -->
    <div class="modal-form" id="form-webblank">
      <div class="form-group">
        <label>URL</label>
        <input type="url" placeholder="https://..." />
      </div>
      <div class="form-group">
        <label>Namn</label>
        <input type="text" placeholder="t.ex. Riksbanken" />
      </div>
      <div class="form-group">
        <label>Uppdateringsfrekvens</label>
        <select>
          <option>Manuellt</option>
          <option>Dagligen</option>
          <option>Veckovis</option>
          <option>Månadsvis</option>
        </select>
      </div>
    </div>

    <div class="modal-actions">
      <button class="btn btn-ghost" onclick="closeModal()">Avbryt</button>
      <button class="btn btn-gold" onclick="saveSource()">Lägg till</button>
    </div>
  </div>
</div>

<!-- ═══ JAVASCRIPT ═══════════════════════════════════ -->
<script>
  // ─── STATE ───────────────────────────────────────────
  let panelOpen = false;
  let activePlatform = 'linkedin';
  let customSources = JSON.parse(localStorage.getItem('ws_sources') || '[]');

  // ─── NEW VIEW NAVIGATION ──────────────────────────────
  const newViewLabels = {
    'dashboard': 'Dashboard',
    'contacts': 'Alla kontakter',
    'pipeline': 'Pipeline',
    'meetings': 'Kommande möten',
    'meeting-notes': 'Mötesanteckningar',
    'offers': 'Aktiva offerter',
    'offer-templates': 'Offertmallar',
    'newsletter-drafts': 'Nyhetsbrev',
    'newsletter-subscribers': 'Prenumeranter',
    'tasks-today': 'Uppgifter — Idag',
    'tasks-week': 'Uppgifter — Denna vecka',
    'ai-agents': 'AI-Team',
    'ai-log': 'Aktivitetslogg'
  };

  const newViewSections = {
    'dashboard': 'Översikt',
    'contacts': 'Kontakter',
    'pipeline': 'Kontakter',
    'meetings': 'Möten',
    'meeting-notes': 'Möten',
    'offers': 'Erbjudanden',
    'offer-templates': 'Erbjudanden',
    'newsletter-drafts': 'Nyhetsbrev',
    'newsletter-subscribers': 'Nyhetsbrev',
    'tasks-today': 'Uppgifter',
    'tasks-week': 'Uppgifter',
    'ai-agents': 'AI-Team',
    'ai-log': 'AI-Team'
  };

  function showNewView(viewId) {
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.querySelector('.main-content').classList.remove('batch-mode');
    const target = document.getElementById('view-' + viewId);
    if (target) target.classList.add('active');

    // Uppdatera sidebar active state
    document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
    document.querySelectorAll('.sidebar-sub-item').forEach(i => i.classList.remove('active'));

    // Breadcrumb
    const section = newViewSections[viewId] || '';
    const label = newViewLabels[viewId] || viewId;
    if (section && section !== label) {
      document.getElementById('breadcrumb').innerHTML = `
        <span class="crumb">${section}</span>
        <span class="sep">›</span>
        <span class="crumb current">${label}</span>
      `;
    } else {
      document.getElementById('breadcrumb').innerHTML = `
        <span class="crumb current">${label}</span>
      `;
    }

    // Stäng generate-panelen om den är öppen
    if (panelOpen) {
      panelOpen = false;
      document.getElementById('generate-panel').classList.add('hidden');
    }
  }

  // ─── SOURCE MAPPING ──────────────────────────────────
  const SOURCE_VIEW_MAP = {
    'Investeringsfilosofi': 'investering',
    'Kundberättelser': 'kund',
    'Marknadskommentarer': 'marknad',
    'Hemsida (cefund.se)': 'hemsida',
    'cefund.se': 'hemsida',
    'Teamets bakgrund': 'team'
  };

  function getSourceText(name) {
    const viewId = SOURCE_VIEW_MAP[name];
    if (viewId) {
      const el = document.getElementById('view-' + viewId);
      return el ? (el.querySelector('.doc-body')?.textContent || '').replace(/\s+/g, ' ').trim() : '';
    }
    const custom = customSources.find(s => s.name === name);
    return custom?.content || '';
  }

  // ─── CLAUDE API ──────────────────────────────────────
  async function callClaude(userMessage) {
    const response = await fetch('/api/claude', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        model: 'claude-sonnet-4-6',
        max_tokens: 2048,
        messages: [{ role: 'user', content: userMessage }]
      })
    });
    const data = await response.json();
    if (!response.ok) throw new Error(data.error?.message || `API-fel ${response.status}`);
    return data.content[0].text;
  }

  // ─── PROMPT BUILDER ──────────────────────────────────
  function buildPrompt(platform, tone, selectedSources) {
    const sourcesText = selectedSources
      .map(name => `### ${name}\n${getSourceText(name)}`)
      .join('\n\n');

    const platformRules = platform === 'linkedin'
      ? `- 150–300 ord\n- Börja med en stark hook (1–2 meningar)\n- Tydliga radbrytningar mellan stycken\n- Avsluta med 3–5 relevanta hashtags på svenska`
      : `- 80–150 ord\n- Får använda emojis för struktur\n- Listor med 1️⃣ 2️⃣ 3️⃣ fungerar bra\n- Avsluta med "Länk i bio 👆" och 5–7 hashtags`;

    return `Du är copywriter för Cefund, ett oberoende finansiellt rådgivningsföretag i Stockholm. Tagline: "Oberoende rådgivning. Ditt bästa intresse, alltid."

Skriv ett ${platform === 'linkedin' ? 'LinkedIn' : 'Instagram'}-inlägg med tonläget "${tone}".

KÄLLMATERIAL:
${sourcesText}

KRAV:
${platformRules}

Returnera BARA inläggstexten — ingen rubrik, ingen förklaring, inga citationstecken runt texten.`;
  }

  // ─── GENERATE SINGLE ─────────────────────────────────
  async function generate() {
    const box = document.getElementById('preview-box');
    const spinner = document.getElementById('preview-spinner');
    const actions = document.getElementById('preview-actions');
    const csvBtn = document.getElementById('btn-add-csv');

    const checkedSources = Array.from(
      document.querySelectorAll('.source-list .source-item input[type="checkbox"]:checked')
    ).map(cb => cb.parentElement.textContent.trim());

    if (checkedSources.length === 0) {
      box.textContent = 'Välj minst en källa för att generera ett inlägg.';
      box.classList.remove('has-content');
      return;
    }

    const tone = document.querySelector('.tone-select').value;
    const prompt = buildPrompt(activePlatform, tone, checkedSources);

    box.textContent = '';
    box.classList.remove('has-content');
    spinner.classList.add('show');
    actions.classList.remove('show');
    if (csvBtn) { csvBtn.textContent = '+ Lägg till i CSV'; csvBtn.classList.remove('btn-added'); csvBtn.disabled = false; }

    try {
      const text = await callClaude(prompt);
      box.textContent = text;
      box.classList.add('has-content');
      actions.classList.add('show');
    } catch (err) {
      box.textContent = `Fel: ${err.message}`;
    } finally {
      spinner.classList.remove('show');
    }
  }

  // ─── ADD SOURCE ──────────────────────────────────────
  function saveSource() {
    const activeForm = document.querySelector('.modal-form.active');
    if (!activeForm) return;
    const type = activeForm.id.replace('form-', '');
    let name = '', content = '';

    if (type === 'transkript' || type === 'dokument') {
      name = activeForm.querySelector('input[type="text"]')?.value.trim() || '';
      content = activeForm.querySelector('textarea')?.value.trim() || '';
    } else if (type === 'webblank') {
      const url = activeForm.querySelector('input[type="url"]')?.value.trim() || '';
      name = activeForm.querySelector('input[type="text"]')?.value.trim() || url;
      content = `URL: ${url}`;
    } else if (type === 'presentation') {
      name = activeForm.querySelector('input[type="text"]')?.value.trim() || '';
      content = '[Presentation – klipp in text från presentationen här]';
    }

    if (!name) { alert('Ange en titel'); return; }
    if (!content || content === '[Presentation – klipp in text från presentationen här]' && type !== 'presentation') {
      alert('Lägg till innehåll'); return;
    }

    const source = { id: Date.now().toString(), name, content, type };
    customSources.push(source);
    localStorage.setItem('ws_sources', JSON.stringify(customSources));

    addSourceToSidebar(source);
    addSourceToPanel(source.name);
    createSourceView(source);
    closeModal();
    activeForm.querySelectorAll('input, textarea').forEach(el => el.value = '');
  }

  function addSourceToSidebar(source) {
    const categoryMap = {
      transkript: 'transkript',
      presentation: 'presentationer',
      dokument: 'dokument',
      webblank: 'weblankar'
    };
    const sub = document.getElementById(categoryMap[source.type] || 'dokument');
    if (!sub) return;
    const item = document.createElement('div');
    item.className = 'sidebar-sub-item';
    item.textContent = source.name;
    item.onclick = function() { showDoc('custom-' + source.id, this); };
    sub.appendChild(item);
  }

  function addSourceToPanel(name) {
    const sourceList = document.querySelector('.source-list');
    if (sourceList) {
      const label = document.createElement('label');
      label.className = 'source-item';
      label.innerHTML = `<input type="checkbox" /> ${name}`;
      sourceList.appendChild(label);
    }
    const chips = document.querySelector('.source-chips');
    if (chips) {
      const chip = document.createElement('label');
      chip.className = 'source-chip';
      chip.innerHTML = `<input type="checkbox" />${name}`;
      chip.onclick = function() { toggleChip(this); };
      chips.appendChild(chip);
    }
  }

  function createSourceView(source) {
    const icons = { transkript: '🎙️', dokument: '📄', presentation: '📊', webblank: '🌐' };
    const typeLabels = { transkript: 'Transkript', dokument: 'Dokument', presentation: 'Presentation', webblank: 'Webblänk' };
    const div = document.createElement('div');
    div.className = 'view';
    div.id = 'view-custom-' + source.id;
    const safeContent = source.content
      .replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;')
      .replace(/\n/g, '</p><p>');
    div.innerHTML = `
      <span class="doc-icon">${icons[source.type] || '📄'}</span>
      <h1 class="doc-title">${source.name}</h1>
      <div class="doc-meta">
        <span>Lagt till ${new Date().toLocaleDateString('sv-SE', {day: 'numeric', month: 'short', year: 'numeric'})}</span>
        <span class="dot">●</span>
        <span>${typeLabels[source.type] || 'Källa'}</span>
      </div>
      <hr class="doc-divider" />
      <div class="doc-body"><p>${safeContent}</p></div>
      <button class="doc-source-btn" onclick="togglePanel()">
        ✨ Generera inlägg från detta källmaterial
      </button>
    `;
    document.querySelector('.main-content').appendChild(div);
  }

  // ─── SEARCH ──────────────────────────────────────────
  function searchSidebar(query) {
    const q = query.toLowerCase().trim();
    document.querySelectorAll('.sidebar-sub-item').forEach(item => {
      item.style.display = !q || item.textContent.toLowerCase().includes(q) ? '' : 'none';
    });
    if (q) {
      document.querySelectorAll('.sidebar-sub').forEach(sub => sub.classList.add('open'));
    }
  }

  // ─── INIT CUSTOM SOURCES ─────────────────────────────
  function initCustomSources() {
    customSources.forEach(source => {
      addSourceToSidebar(source);
      addSourceToPanel(source.name);
      createSourceView(source);
    });
  }

  const samplePosts = {
    linkedin: `Många av mina kunder kommer med en känsla av att deras ekonomi är utspridd och ostrukturerad — pengar på sju ställen, fonder de inte minns att de valt, och en pension de inte förstår.

Det är inte deras fel. Det är systemet.

Finansiella produkter är designade för att vara svåra att jämföra. Det är lättare att sälja ett komplicerat paket än att förklara en enkel strategi.

Hos Cefund börjar vi alltid med att kartlägga allt: var varje krona finns, vad den kostar, och vad den egentligen är till för.

Sedan bygger vi ihop ett system där delarna samverkar.

Tre frågor du kan ställa dig nu:
→ Vet du exakt vad du betalar i avgifter för din pension?
→ Har du en buffert som är åtskild från din investering?
→ Jobbar ditt bolags överskott aktivt — eller "väntar" det?

Om svaret är nej på någon av dessa, hör av dig.

#finansiellrådgivning #cefund #oberoende #pension #förmögenhetsplanering`,

    instagram: `Pengarna i ditt bolag borde jobba.

Inte "vänta". 💡

Här är 3 saker vi hjälper företagare att göra med överskottet:

1️⃣ Kapitalförsäkring i bolaget
→ Lägre skatt på avkastning, enklare administration

2️⃣ Pensionsavsättning
→ Avdragsgill för bolaget, skatteuppskjuten för dig

3️⃣ Aktiv allokering
→ Istället för 0,01% på företagskontot

Vill du veta hur det funkar för just ditt bolag?
Länk i bio 👆

#cefund #företagarekonomi #pension #kapitalförvaltning #oberoenderådgivning`
  };

  function togglePanel() {
    const panel = document.getElementById('generate-panel');
    panelOpen = !panelOpen;
    panel.classList.toggle('hidden', !panelOpen);
  }

  function showDoc(docId, el) {
    // Deactivate all views
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    // Activate target view
    const target = document.getElementById('view-' + docId);
    if (target) target.classList.add('active');

    // Update sidebar active state
    document.querySelectorAll('.sidebar-sub-item').forEach(i => i.classList.remove('active'));
    if (el) el.classList.add('active');

    // Update breadcrumb
    const titles = {
      investering: 'Investerardag feb 2026',
      kund: 'Kundpresentation Q1 2026',
      marknad: 'Marknadskommentarer feb',
      team: 'Teamets bakgrund',
      hemsida: 'cefund.se'
    };
    const parents = {
      investering: 'Transkript',
      kund: 'Presentationer',
      marknad: 'Dokument',
      team: 'Dokument',
      hemsida: 'Webblänkar'
    };
    document.getElementById('breadcrumb').innerHTML = `
      <span class="crumb">${parents[docId] || 'Bibliotek'}</span>
      <span class="sep">›</span>
      <span class="crumb current">${titles[docId] || docId}</span>
    `;
  }

  function showView(viewId) {
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    const target = document.getElementById('view-' + viewId);
    if (target) target.classList.add('active');

    const labels = {
      posts: 'Inlägg',
      published: 'Publicerat'
    };

    if (labels[viewId]) {
      document.getElementById('breadcrumb').innerHTML = `
        <span class="crumb current">${labels[viewId]}</span>
      `;
    }
  }

  function toggleSection(sectionId, el) {
    const sub = document.getElementById(sectionId);
    if (!sub) return;
    const isOpen = sub.classList.contains('open');
    sub.classList.toggle('open', !isOpen);
    el.classList.toggle('expanded', !isOpen);
  }

  function filterPosts(platform, el) {
    showView('posts');
    document.querySelectorAll('.sidebar-sub-item').forEach(i => i.classList.remove('active'));
    el.classList.add('active');
  }

  function setPlatform(platform, el) {
    activePlatform = platform;
    document.querySelectorAll('.platform-tab').forEach(t => t.classList.remove('active'));
    el.classList.add('active');
  }

  // generate() definieras ovan (Claude API-version)

  function copyPreview() {
    const text = document.getElementById('preview-box').textContent;
    navigator.clipboard.writeText(text).then(() => {
      const btn = event.target;
      btn.textContent = 'Kopierat ✓';
      setTimeout(() => { btn.textContent = 'Kopiera'; }, 2000);
    });
  }

  // ─── BATCH STUDIO ─────────────────────────────────────
  const batchSamples = {
    'linkedin-tankeled': [
      `Många av mina kunder kommer med en känsla av att deras ekonomi är utspridd och ostrukturerad — pengar på sju ställen, fonder de inte minns att de valt, och en pension de inte förstår.

Det är inte deras fel. Det är systemet.

Finansiella produkter är designade för att vara svåra att jämföra. Det är lättare att sälja ett komplicerat paket än att förklara en enkel strategi.

Hos Cefund börjar vi alltid med att kartlägga allt: var varje krona finns, vad den kostar, och vad den egentligen är till för.

Tre frågor du kan ställa dig nu:
→ Vet du exakt vad du betalar i avgifter för din pension?
→ Har du en buffert som är åtskild från din investering?
→ Jobbar ditt bolags överskott aktivt — eller "väntar" det?

#finansiellrådgivning #cefund #oberoende #pension`,

      `De flesta pratar om att "tajma marknaden". Köpa lågt, sälja högt.

Det låter enkelt. Det funkar inte.

Studier visar att privatinvesterare konsekvent underpresterar index — inte för att de väljer fel aktier, utan för att de säljer när det faller och köper när det stiger. Precis tvärtom mot vad som krävs.

Tid i marknaden slår market timing. Alltid.

Det bästa du kan göra: välj en allokering du kan leva med även när det faller 30 %. Sedan — håll fast vid den. Det är allt.

#investering #langsiktigtspara #cefund #fondspara`,

      `Oberoende rådgivning är inte ett buzzword. Det är en affärsmodell.

Vi tar betalt av dig. Inte av banker. Inte av fondbolag. Inte av försäkringsbolag.

Det innebär att det aldrig finns ett inbyggt skäl för oss att rekommendera produkt A framför produkt B — förutom att A passar dig bättre.

Det är en liten förändring i hur vi tjänar pengar. Det är en enorm förändring i vilka råd du får.

Sedan 2021 har vi hjälpt 200+ familjer och företagare att bygga ekonomisk struktur utan intressekonflikter.

#cefund #oberoende #finansiellrådgivning #transparent`,

      `Riksbanken sänker räntan. Vad innebär det för dig?

1. Rörligt bolån → lägre månadskostnad direkt
2. Räntesparande → avkastningen sjunker
3. Aktier → historiskt positivt på kort sikt
4. Fastigheter → efterfrågan kan öka igen

Det viktiga är inte att förutspå exakt vad som händer — utan att förstå hur din portfölj är exponerad mot ränteförändringar.

Vet du det?

#riksbanken #ränta #privatekonomi #cefund`
    ],
    'linkedin-tips': [
      `5 misstag som kostar dig pengar på pensionen — och hur du undviker dem.

1️⃣ Aldrig sett över fondvalet
→ Standardalternativet är sällan det bästa för dig

2️⃣ Betalar för höga avgifter
→ 1% i avgift = hundratusentals kronor borta vid 65

3️⃣ Blandar ihop buffert och investering
→ Det som ska vara trygghet ska inte vara i aktier

4️⃣ Tar ut för lite i lön
→ Pensionsgrundande inkomst påverkas direkt

5️⃣ Skjuter upp beslutet
→ Tid är din mest värdefulla tillgång i sparande

Vilket av dessa känner du igen dig i?

#pension #tjänstepension #cefund #spara`,

      `Tre saker du kan göra med överskottet i bolaget — rangordnade efter skatteeffektivitet.

1️⃣ Kapitalförsäkring i bolaget
Schablonbeskattad. Enkel administration. Bra för långsiktigt kapital.

2️⃣ Pensionsavsättning (§28A)
Avdragsgill kostnad för bolaget. Skatteuppskjuten för dig personligen.

3️⃣ Utdelning via 3:12
Effektivt om du kvalificerar för lågbeskattad utdelning (gränsbeloppet).

Vilket alternativ som passar bäst beror på din personliga situation. Men att låta pengarna "vänta" på kontot är aldrig rätt svar.

#bolagsstruktur #cefund #skatt #företagande`
    ],
    'ig-quote': [
      `"Det bästa investeringsbeslutet du kan fatta är att inte fatta ett beslut i panik."

— Cefund`,

      `"Tid i marknaden slår alltid timing av marknaden."

— Cefund`,

      `"Oberoende rådgivning är inte ett löfte. Det är en affärsmodell."

— Cefund`
    ],
    'ig-karusell': [
      `Bild 1: Pensionen — allt du inte visste att du inte visste 🧵

Bild 2: Visste du att avgiften på din fond kan kosta dig 400 000 kr vid pensionen?

Bild 3: Standardvalet är sällan det bästa valet. Majoriteten byter aldrig fond.

Bild 4: Lösningen: se över fondvalet en gång per år. Det tar 10 minuter.

Bild 5: Vill du veta hur din pension ser ut? Länk i bio 👆

#pension #spara #privatekonomi #cefund`,

      `Bild 1: 3 vanliga misstag med bolagspengar 💡

Bild 2: Misstag 1 — Låta pengarna "vänta" på kontot till 0,01% ränta

Bild 3: Misstag 2 — Aldrig sätta upp en pensionsavsättning

Bild 4: Misstag 3 — Inte använda kapitalförsäkringens skattefördelar

Bild 5: Pengarna i ditt bolag borde jobba. Länk i bio 👆

#företagande #bolag #cefund #kapitalförvaltning`
    ]
  };

  const typeLabels = {
    'linkedin-tankeled': { platform: 'linkedin', label: '💼 LinkedIn', type: 'Tankeledare' },
    'linkedin-tips':     { platform: 'linkedin', label: '💼 LinkedIn', type: 'Tipslista' },
    'ig-quote':          { platform: 'instagram', label: '📸 Instagram', type: 'Quote' },
    'ig-karusell':       { platform: 'instagram', label: '📸 Instagram', type: 'Karusell' }
  };

  let selectedBatchType = 'linkedin-tankeled';
  let batchSelected = new Set();

  function selectType(type, el) {
    selectedBatchType = type;
    document.querySelectorAll('.type-card').forEach(c => c.classList.remove('active'));
    el.classList.add('active');
  }

  function toggleChip(el) {
    el.classList.toggle('checked');
  }

  function showBatch() {
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.getElementById('view-batch').classList.add('active');
    document.querySelector('.main-content').classList.add('batch-mode');
    document.getElementById('breadcrumb').innerHTML =
      `<span class="crumb current">⚡ Generera flera</span>`;
  }

  // Rensa batch-mode när man navigerar bort
  const _origShowView = showView;
  showView = function(viewId) {
    document.querySelector('.main-content').classList.remove('batch-mode');
    _origShowView(viewId);
  };

  const _origShowDoc = showDoc;
  showDoc = function(docId, el) {
    document.querySelector('.main-content').classList.remove('batch-mode');
    _origShowDoc(docId, el);
  };

  const batchTypeInstructions = {
    'linkedin-tankeled': 'Tankeledare: Inled med stark hook. Dela en insikt. Avsluta med fråga eller CTA. Korta stycken.',
    'linkedin-tips':     'Tipslista: Tydlig rubrik. Numrerade tips (3–5 st) med kort förklaring. Avsluta med hashtags.',
    'ig-quote':          'Quote: Kort, slagkraftigt citat på 1–2 meningar, sedan "— Cefund" på ny rad.',
    'ig-karusell':       'Karusell: "Bild 1: [hook]\n\nBild 2: [poäng]\n\nBild 3: [poäng]\n\nBild 4: [poäng]\n\nBild 5: [CTA + hashtags]"'
  };

  function makeBatchCard(i, meta, text) {
    const num = document.createElement('span');
    num.className = 'batch-card-num';
    num.textContent = i + 1;

    const badge = document.createElement('span');
    badge.className = 'post-platform ' + meta.platform;
    badge.textContent = meta.label;

    const typeTag = document.createElement('span');
    typeTag.className = 'batch-card-type';
    typeTag.textContent = meta.type;

    const cb = document.createElement('input');
    cb.type = 'checkbox';
    cb.className = 'batch-check';
    cb.addEventListener('change', () => toggleBatchSelect(i, cb));

    const header = document.createElement('div');
    header.className = 'batch-card-header';
    header.append(num, badge, typeTag, cb);

    const body = document.createElement('div');
    body.className = 'batch-card-body';
    body.contentEditable = 'true';
    body.textContent = text;
    body.addEventListener('input', () => updateCharCount(body, i));

    const charEl = document.createElement('span');
    charEl.className = 'batch-char-count';
    charEl.id = 'char-' + i;
    charEl.textContent = text.length + ' tecken';

    const välj = document.createElement('button');
    välj.className = 'btn-copy';
    välj.textContent = '+ Välj';
    välj.addEventListener('click', () => selectSingle(i, cb));

    const footer = document.createElement('div');
    footer.className = 'batch-card-footer';
    footer.append(charEl, välj);

    const card = document.createElement('div');
    card.className = 'batch-card';
    card.dataset.idx = i;
    card.append(header, body, footer);
    return card;
  }

  async function batchGenerate() {
    const type = selectedBatchType;
    const meta = typeLabels[type];
    const grid = document.getElementById('batch-grid');
    const empty = document.getElementById('batch-empty');
    const btn = document.querySelector('.batch-generate-btn');

    const checkedSources = Array.from(
      document.querySelectorAll('.source-chips .source-chip.checked')
    ).map(chip => chip.textContent.trim());

    if (checkedSources.length === 0) {
      alert('Välj minst en källa');
      return;
    }

    const tone = document.querySelector('.config-select').value;

    const prompt = `Du är copywriter för Cefund, ett oberoende finansiellt rådgivningsföretag i Stockholm.

Generera 7 unika ${meta.platform === 'linkedin' ? 'LinkedIn' : 'Instagram'}-inlägg av typen "${meta.type}" med tonläget "${tone}".

KÄLLMATERIAL:
${checkedSources.map(name => `### ${name}\n${getSourceText(name)}`).join('\n\n')}

FORMAT FÖR VARJE INLÄGG:
${batchTypeInstructions[type] || 'Standard inlägg med hook, brödtext och hashtags.'}

VIKTIGT: Separera varje inlägg med exakt denna rad på en egen rad: ---INLÄGG---
Returnera BARA de 7 inläggen. Inga kommentarer, inga numreringar utanför texten.`;

    batchSelected.clear();
    updateBatchBar();
    grid.innerHTML = '';
    empty.style.display = 'none';
    grid.style.display = 'grid';

    for (let i = 0; i < 7; i++) {
      grid.appendChild(makeBatchCard(i, meta, '⏳ Genererar...'));
    }

    if (btn) { btn.disabled = true; btn.textContent = '⏳ Genererar...'; }

    try {
      const text = await callClaude(prompt);
      const posts = text.split('---INLÄGG---').map(p => p.trim()).filter(Boolean);

      for (let i = 0; i < 7; i++) {
        const body = document.querySelector(`.batch-card[data-idx="${i}"] .batch-card-body`);
        if (body) {
          const content = posts[i] || posts[i % Math.max(posts.length, 1)] || '';
          body.textContent = content;
          updateCharCount(body, i);
        }
      }
    } catch (err) {
      for (let i = 0; i < 7; i++) {
        const body = document.querySelector(`.batch-card[data-idx="${i}"] .batch-card-body`);
        if (body) body.textContent = `Fel: ${err.message}`;
      }
    } finally {
      if (btn) { btn.disabled = false; btn.textContent = '✨ Generera 7 inlägg'; }
    }
  }

  function toggleBatchSelect(idx, checkbox) {
    const card = document.querySelector(`.batch-card[data-idx="${idx}"]`);
    if (checkbox.checked) {
      batchSelected.add(idx);
      card.classList.add('selected');
    } else {
      batchSelected.delete(idx);
      card.classList.remove('selected');
    }
    updateBatchBar();
  }

  function selectSingle(idx, cb) {
    cb.checked = !cb.checked;
    toggleBatchSelect(idx, cb);
  }

  function updateCharCount(el, idx) {
    const count = el.textContent.length;
    const countEl = document.getElementById('char-' + idx);
    if (countEl) {
      countEl.textContent = count + ' tecken';
      countEl.classList.toggle('over', count > 3000);
    }
  }

  function updateBatchBar() {
    const bar = document.getElementById('batch-export-bar');
    const countEl = document.getElementById('batch-count');
    countEl.textContent = batchSelected.size;
    bar.classList.toggle('visible', batchSelected.size > 0);
  }

  function clearBatchSelection() {
    batchSelected.clear();
    document.querySelectorAll('.batch-card').forEach(c => c.classList.remove('selected'));
    document.querySelectorAll('.batch-check').forEach(cb => cb.checked = false);
    updateBatchBar();
  }

  function exportBatchCSV() {
    const type = selectedBatchType;
    const headers = ['Hook', 'Text', 'Hashtags', 'Typ', 'Plattform'];
    const rows = [];
    batchSelected.forEach(idx => {
      const body = document.querySelector(`.batch-card[data-idx="${idx}"] .batch-card-body`);
      if (!body) return;
      const { hook, body: bodyText, hashtags } = parsePost(body.textContent.trim());
      const meta = typeLabels[type];
      rows.push([hook, bodyText, hashtags, meta.type, meta.label].map(csvCell).join(','));
    });
    if (!rows.length) return;
    const csv = '\ufeff' + [headers.join(','), ...rows].join('\r\n');
    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `canva-${type}.csv`;
    a.click();
    URL.revokeObjectURL(url);
  }

  // ─── MODAL ────────────────────────────────────────────
  function openModal(type) {
    document.getElementById('modal-overlay').classList.add('open');
    setModalType(type);
  }

  function closeModal() {
    document.getElementById('modal-overlay').classList.remove('open');
  }

  function handleOverlayClick(e) {
    if (e.target === document.getElementById('modal-overlay')) closeModal();
  }

  function setModalType(type, clickedTab) {
    document.querySelectorAll('.modal-form').forEach(f => f.classList.remove('active'));
    document.querySelectorAll('.modal-tab').forEach(t => t.classList.remove('active'));
    const form = document.getElementById('form-' + type);
    if (form) form.classList.add('active');
    if (clickedTab) {
      clickedTab.classList.add('active');
    } else {
      const tab = document.querySelector(`.modal-tab[data-type="${type}"]`);
      if (tab) tab.classList.add('active');
    }
  }

  // ─── POST DETAIL ──────────────────────────────────────
  const postData = [
    {
      platform: 'linkedin',
      platformLabel: '💼 LinkedIn',
      date: '14 feb 2026',
      title: 'Varför oberoende rådgivning ger bättre resultat',
      body: `De flesta råd du får om din ekonomi kommer från någon som tjänar pengar på att du köper en viss produkt. Det är inte ett anklagande — det är systemet. Men det är viktigt att förstå hur det påverkar rådet du får.

En bankrådgivare som säljer fondportföljer tjänar mer om du väljer deras fonder. En försäkringsmäklare tjänar på premien. Det skapar en inbyggd intressekonflikt — hur välmenande personen än är.

Oberoende rådgivning löser det grundläggande problemet: vi tjänar pengar av dig, inte av produkterna vi rekommenderar.

Det låter som en liten skillnad. Det är en enorm skillnad.

#finansiellrådgivning #cefund #oberoende #förmögenhetsplanering`
    },
    {
      platform: 'instagram',
      platformLabel: '📸 Instagram',
      date: '11 feb 2026',
      title: '3 saker du borde göra med ditt bolags överskott',
      body: `Har du pengar som "väntar" i ditt bolag utan att göra nytta? Du är inte ensam. Här är de tre vanligaste misstagen — och vad du kan göra istället 👇

1️⃣ Kapitalförsäkring i bolaget
→ Lägre skatt på avkastning, enklare administration

2️⃣ Pensionsavsättning
→ Avdragsgill för bolaget, skatteuppskjuten för dig

3️⃣ Aktiv allokering
→ Istället för 0,01% på företagskontot

Länk i bio 👆

#cefund #företagarekonomi #pension #kapitalförvaltning`
    },
    {
      platform: 'linkedin',
      platformLabel: '💼 LinkedIn',
      date: '5 feb 2026',
      title: 'Riksbankens signaler — vad betyder det för dig?',
      body: `Riksbanken signalerade vid senaste mötet att ytterligare räntesänkningar kan komma under Q1. Det kan låta som en nyhet för makroekonomer — men det har konkreta konsekvenser för dig som privatperson.

Lägre ränta innebär bland annat:
→ Billigare bolån (om du har rörlig ränta)
→ Lägre avkastning på räntesparande
→ Fastighetspriserna kan röra sig uppåt igen

För dig med ett bolag: kapitalförsäkringens skattemässiga ränta (statslåneräntan) justeras också — vilket påverkar hur mycket du betalar i skatt på avkastningen.

Vill du veta hur du bör positionera dig? Hör av dig.

#riksbanken #ränta #privatekonomi #cefund #finansiellrådgivning`
    },
    {
      platform: 'instagram',
      platformLabel: '📸 Instagram',
      date: '28 jan 2026',
      title: 'Pensionssparande: det du inte visste att du inte visste',
      body: `Visste du att valet av fonder i ditt tjänstepension kan skilja hundratusentals kronor vid pensionering — med exakt samma insättningar?

Det handlar om avgifter och allokering.

En fond med 1,5% avgift vs 0,2% avgift:
På 30 år och 5 000 kr/mån → skillnad på +400 000 kr 😶

De flesta väljer aldrig aktivt. De hamnar i standardalternativet.

Kolla ditt val idag. Det tar 5 minuter och kan vara det bästa du gör för framtida dig.

#pension #tjänstepension #spara #privatekonomi #cefund`
    }
  ];

  function showPostDetail(idx) {
    const p = postData[idx];
    const platformEl = document.getElementById('detail-platform');
    platformEl.textContent = p.platformLabel;
    platformEl.className = 'post-platform ' + p.platform;
    document.getElementById('detail-date').textContent = p.date;
    document.getElementById('detail-title').textContent = p.title;
    document.getElementById('detail-body').textContent = p.body;

    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.getElementById('view-post-detail').classList.add('active');
    document.getElementById('breadcrumb').innerHTML = `
      <span class="crumb" onclick="showView('posts')" style="cursor:pointer;">Inlägg</span>
      <span class="sep">›</span>
      <span class="crumb current">${p.title}</span>
    `;
  }

  // ─── CSV EXPORT ───────────────────────────────────────
  let postQueue = [];

  function parsePost(text) {
    const lines = text.split('\n');
    const nonEmpty = lines.filter(l => l.trim());
    const hook = nonEmpty[0] || '';
    const hashtagLines = lines.filter(l => l.trim().startsWith('#'));
    const hashtags = hashtagLines.join(' ').trim();
    const body = lines
      .slice(lines.indexOf(lines.find(l => l.trim() === hook)) + 1)
      .filter(l => !l.trim().startsWith('#'))
      .join('\n')
      .trim();
    return { hook, body, hashtags };
  }

  function addToCSV() {
    const text = document.getElementById('preview-box').textContent.trim();
    if (!text || text.startsWith('Välj källor')) return;

    const { hook, body, hashtags } = parsePost(text);
    const platform = activePlatform === 'linkedin' ? 'LinkedIn' : 'Instagram';
    postQueue.push({ hook, body, hashtags, platform });

    const btn = document.getElementById('btn-add-csv');
    btn.textContent = 'Tillagd ✓';
    btn.classList.add('btn-added');
    btn.disabled = true;

    updateCSVFooter();
  }

  function updateCSVFooter() {
    document.getElementById('csv-count').textContent = postQueue.length;
    const dlBtn = document.getElementById('csv-download-btn');
    dlBtn.disabled = postQueue.length === 0;
    dlBtn.classList.toggle('ready', postQueue.length > 0);
  }

  function csvCell(val) {
    return '"' + String(val).replace(/"/g, '""') + '"';
  }

  function downloadCSV() {
    if (postQueue.length === 0) return;
    const headers = ['Hook', 'Text', 'Hashtags', 'Plattform'];
    const rows = postQueue.map(p =>
      [p.hook, p.body, p.hashtags, p.platform].map(csvCell).join(',')
    );
    const csv = '\ufeff' + [headers.join(','), ...rows].join('\r\n');
    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'canva-inlagg.csv';
    a.click();
    URL.revokeObjectURL(url);
  }

  // ─── EVENT NAVIGATION ─────────────────────────────────
  const eventData = {
    varmingel: {
      title: 'Vårmingel 15 mars',
      date: '15 mars 2026, 17:00–20:00',
      location: 'Brasserie Astoria, Nybrogatan 6, Stockholm',
      type: 'Mingel & networking',
      description: 'Informellt mingel för befintliga kunder och prospects. Syftet är att stärka relationer och presentera Cefunds tjänster i en avslappnad miljö.',
      badge: 'Planering',
      badgeClass: 'planering',
      guests: 24, confirmed: 12, pending: 9, declined: 3
    },
    kundevent: {
      title: 'Kundevent april',
      date: '10 april 2026, 18:00–21:00',
      location: 'Fotografiska, Stadsgårdshamnen 22, Stockholm',
      type: 'Presentation & mingel',
      description: 'Kundkväll med kort presentation om marknadsutsikter 2026, följt av mingel. Fokus på befintliga kunder och deras nätverk.',
      badge: 'Bekräftat',
      badgeClass: 'bekraftat',
      guests: 42, confirmed: 28, pending: 11, declined: 3
    }
  };

  function showEvents() {
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.querySelector('.main-content').classList.remove('batch-mode');
    document.getElementById('view-events').classList.add('active');
    document.getElementById('breadcrumb').innerHTML =
      '<span class="crumb current">Kommande event</span>';

    // Uppdatera sidebar active state
    document.querySelectorAll('.sidebar-sub-item').forEach(i => i.classList.remove('active'));
  }

  function showEvent(eventId, el) {
    const data = eventData[eventId];
    if (!data) return;

    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.querySelector('.main-content').classList.remove('batch-mode');

    // Uppdatera event-detail med rätt data
    document.getElementById('event-detail-title').textContent = data.title;
    document.getElementById('event-detail-meta').innerHTML = `
      <span>📅 ${data.date}</span>
      <span class="dot">●</span>
      <span>📍 ${data.location.split(',')[0]}</span>
    `;

    document.getElementById('view-event-detail').classList.add('active');

    // Breadcrumb
    document.getElementById('breadcrumb').innerHTML = `
      <span class="crumb" onclick="showEvents()" style="cursor:pointer;">Kommande event</span>
      <span class="sep">›</span>
      <span class="crumb current">${data.title}</span>
    `;

    // Sidebar active
    document.querySelectorAll('.sidebar-sub-item').forEach(i => i.classList.remove('active'));
    if (el) el.classList.add('active');
  }

  function showGuestlist(eventId, el) {
    const data = eventData[eventId];
    if (!data) return;

    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.querySelector('.main-content').classList.remove('batch-mode');

    // Uppdatera gästlista-vy
    document.getElementById('guestlist-title').textContent = 'Gästlista';
    document.getElementById('guestlist-event').textContent = data.title;
    document.getElementById('guestlist-summary').innerHTML = `
      <div class="event-summary-badge"><strong>${data.guests}</strong> Totalt</div>
      <div class="event-summary-badge"><strong>${data.confirmed}</strong> Bekräftade</div>
      <div class="event-summary-badge"><strong>${data.pending}</strong> Väntande</div>
      <div class="event-summary-badge"><strong>${data.declined}</strong> Tackat nej</div>
    `;

    document.getElementById('view-guestlist').classList.add('active');

    // Breadcrumb
    document.getElementById('breadcrumb').innerHTML = `
      <span class="crumb" onclick="showEvents()" style="cursor:pointer;">Event</span>
      <span class="sep">›</span>
      <span class="crumb" onclick="showEvent('${eventId}')" style="cursor:pointer;">${data.title}</span>
      <span class="sep">›</span>
      <span class="crumb current">Gästlista</span>
    `;

    // Sidebar active
    document.querySelectorAll('.sidebar-sub-item').forEach(i => i.classList.remove('active'));
    if (el) el.classList.add('active');
  }

  // Utöka showView för event-archive
  const _origShowViewEvent = showView;
  showView = function(viewId) {
    if (viewId === 'events-archive') {
      document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
      document.querySelector('.main-content').classList.remove('batch-mode');
      document.getElementById('view-events-archive').classList.add('active');
      document.getElementById('breadcrumb').innerHTML =
        '<span class="crumb current">Tidigare event</span>';
      document.querySelectorAll('.sidebar-sub-item').forEach(i => i.classList.remove('active'));
      return;
    }
    _origShowViewEvent(viewId);
  };

  // ─── ÖVERSIKT / PIPELINE / KALENDER ─────────────────
  function showOversikt() {
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.querySelector('.main-content').classList.remove('batch-mode');
    document.getElementById('view-oversikt').classList.add('active');
    document.getElementById('breadcrumb').innerHTML =
      '<span class="crumb current">🏠 Översikt</span>';
  }

  function showPipeline() {
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.querySelector('.main-content').classList.remove('batch-mode');
    document.getElementById('view-pipeline').classList.add('active');
    document.getElementById('breadcrumb').innerHTML =
      '<span class="crumb current">🗂️ Pipeline</span>';
  }

  function showKalender() {
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.querySelector('.main-content').classList.remove('batch-mode');
    document.getElementById('view-kalender').classList.add('active');
    document.getElementById('breadcrumb').innerHTML =
      '<span class="crumb current">🗓️ Kalender</span>';
  }

  function movePipeCard(btn, targetColId) {
    const card = btn.closest('.pipe-card');
    const targetCards = document.getElementById('pipe-cards-' + targetColId);
    if (!targetCards) return;

    if (targetColId === 'publicerat') {
      btn.remove();
    } else {
      const nextMap = { klar: 'schemalagd', schemalagd: 'publicerat' };
      const nextLabels = { schemalagd: '→ Schemalägg', publicerat: '→ Publicerat' };
      const next = nextMap[targetColId];
      if (next) {
        btn.textContent = nextLabels[next] || '→ ' + next;
        btn.setAttribute('onclick', `movePipeCard(this, '${next}')`);
      }
    }

    targetCards.appendChild(card);

    ['klar', 'schemalagd', 'publicerat'].forEach(col => {
      const countEl = document.getElementById('pipe-count-' + col);
      const cardsEl = document.getElementById('pipe-cards-' + col);
      if (countEl && cardsEl) {
        countEl.textContent = cardsEl.querySelectorAll('.pipe-card').length;
      }
    });
  }

  // Init
  const dokunentEl = document.getElementById('dokument');
  if (dokunentEl) dokunentEl.classList.add('open');
  initCustomSources();
</script>
</body>
</html>
